<!doctype html>
<meta charset="utf-8" />
<meta name="color-scheme" content="light dark" />
<meta name="robots" content="noindex" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="icon" type="image/x-icon" href="./favicon.ico">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<title>~</title>

<!-- Preload theme script to prevent flash -->
<script>
    // Apply theme immediately before page renders to prevent flash
    (function() {
        try {
            const savedSettings = localStorage.getItem('homeSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                const themeName = settings.theme || 'default';
                const isDarkMode = settings.darkMode || false;
                
                // Apply dark mode class
                document.documentElement.classList.toggle('dark-mode', isDarkMode);
                
                // Store theme data in a data attribute for components to access
                document.documentElement.dataset.theme = themeName;
                document.documentElement.dataset.darkMode = isDarkMode;
                
                // Define basic theme properties - just enough to prevent flash
                const BASIC_THEMES = {
                    default: {
                        light: {
                            background: '#f8f5e6',
                            gradient: 'linear-gradient(135deg, #f8f5e6, #f2edd0)',
                            text: '#222222'
                        },
                        dark: {
                            background: '#1a1a1a',
                            gradient: 'linear-gradient(135deg, #222, #333)',
                            text: '#e0e0e0'
                        }
                    },
                    minimal: {
                        light: {
                            background: '#ffffff',
                            gradient: 'none',
                            text: '#000000'
                        },
                        dark: {
                            background: '#000000',
                            gradient: 'none',
                            text: '#ffffff'
                        }
                    },
                    glass: {
                        light: {
                            background: 'rgba(255, 255, 255, 0.7)',
                            gradient: 'linear-gradient(135deg, #f5f7fa, #c3cfe2)',
                            text: '#334155'
                        },
                        dark: {
                            background: 'rgba(15, 23, 42, 0.7)',
                            gradient: 'linear-gradient(135deg, #0f172a, #1e293b)',
                            text: '#e2e8f0'
                        }
                    },
                    ocean: {
                        light: {
                            background: '#e0f7fa',
                            gradient: 'linear-gradient(135deg, #e0f7fa, #80deea 50%, #4dd0e1)',
                            text: '#006064'
                        },
                        dark: {
                            background: '#002f35',
                            gradient: 'linear-gradient(135deg, #002f35, #00363a 50%, #004d40)',
                            text: '#e0f7fa'
                        }
                    },
                    swiss: {
                        light: {
                            background: '#ffffff',
                            gradient: 'none',
                            text: '#111111'
                        },
                        dark: {
                            background: '#000000',
                            gradient: 'none',
                            text: '#ffffff'
                        }
                    },
                    // New themes added below
                    neon: {
                        light: {
                            background: '#0f0f1a',
                            gradient: 'radial-gradient(circle at top right, rgba(120, 0, 255, 0.2), transparent), radial-gradient(circle at bottom left, rgba(0, 255, 255, 0.2), transparent)',
                            text: '#ffffff'
                        },
                        dark: {
                            background: '#0a0a12',
                            gradient: 'radial-gradient(circle at top right, rgba(120, 0, 255, 0.3), transparent), radial-gradient(circle at bottom left, rgba(0, 255, 255, 0.3), transparent)',
                            text: '#ffffff'
                        }
                    },
                    retro: {
                        light: {
                            background: '#faf4d4',
                            gradient: 'linear-gradient(135deg, #faf4d4, #f9c58d)',
                            text: '#562349'
                        },
                        dark: {
                            background: '#2c1320',
                            gradient: 'linear-gradient(135deg, #2c1320, #42253b)',
                            text: '#f9c58d'
                        }
                    },
                    brutalist: {
                        light: {
                            background: '#ffffff',
                            gradient: 'none',
                            text: '#000000'
                        },
                        dark: {
                            background: '#000000',
                            gradient: 'none',
                            text: '#ffffff'
                        }
                    },
                    gaming: {
                        light: {
                            background: '#121212',
                            gradient: 'linear-gradient(135deg, #121212, #1a1a1a)',
                            text: '#e0e0e0'
                        },
                        dark: {
                            background: '#0a0a0a',
                            gradient: 'linear-gradient(135deg, #0a0a0a, #151515)',
                            text: '#e0e0e0'
                        }
                    },
                    cyberpunk: {
                        light: {
                            background: '#0c0c14',
                            gradient: 'linear-gradient(135deg, #0c0c14, #0f1023), radial-gradient(at top right, rgba(255, 30, 86, 0.3), transparent 70%), radial-gradient(at bottom left, rgba(0, 255, 230, 0.3), transparent 70%)',
                            text: '#f2f2f2'
                        },
                        dark: {
                            background: '#080810',
                            gradient: 'linear-gradient(135deg, #080810, #0a0a18), radial-gradient(at top right, rgba(255, 30, 86, 0.4), transparent 70%), radial-gradient(at bottom left, rgba(0, 255, 230, 0.4), transparent 70%)',
                            text: '#f2f2f2'
                        }
                    },
                    bauhaus: {
                        light: {
                            background: '#ffffff',
                            gradient: 'radial-gradient(circle at center, #ffffff 50%, #f0f0f0 100%)',
                            text: '#000000'
                        },
                        dark: {
                            background: '#121212',
                            gradient: 'radial-gradient(circle at center, #121212 50%, #0a0a0a 100%)',
                            text: '#ffffff'
                        }
                    },
                    vaporwave: {
                        light: {
                            background: '#c6a4f2',
                            gradient: 'linear-gradient(135deg, #c6a4f2, #fd7ab8), radial-gradient(at top right, rgba(117, 255, 225, 0.7), transparent)',
                            text: '#1f0033'
                        },
                        dark: {
                            background: '#2d1259',
                            gradient: 'linear-gradient(135deg, #2d1259, #5b2180), radial-gradient(at top right, rgba(255, 182, 193, 0.4), transparent)',
                            text: '#fbceff'
                        }
                    },
                    nordic: {
                        light: {
                            background: '#f8f9fa',
                            gradient: 'linear-gradient(135deg, #f8f9fa, #e9ecef)',
                            text: '#212529'
                        },
                        dark: {
                            background: '#212529',
                            gradient: 'linear-gradient(135deg, #212529, #343a40)',
                            text: '#f8f9fa'
                        }
                    }
                };
                
                // Apply basic colors immediately
                const theme = BASIC_THEMES[themeName] || BASIC_THEMES.default;
                const colors = isDarkMode ? theme.dark : theme.light;
                
                document.documentElement.style.backgroundColor = colors.background;
                document.documentElement.style.color = colors.text;
                
                if (colors.gradient && colors.gradient !== 'none') {
                    document.documentElement.style.backgroundImage = colors.gradient;
                }
            }
        } catch (e) {
            console.error('Error pre-loading theme:', e);
        }
    })();
</script>

<script>
    // Initialize and load saved shortcuts
    document.addEventListener('DOMContentLoaded', function() {
        // Mark body as loading
        document.body.classList.add('loading');
        
        // Load saved commands if they exist
        try {
            const savedCommands = localStorage.getItem('homeCommands');
            if (savedCommands) {
                const commandsArray = JSON.parse(savedCommands);
                // Clear the existing commands and add the saved ones
                if (typeof COMMANDS !== 'undefined') {
                    COMMANDS.clear();
                    for (const [key, value] of commandsArray) {
                        COMMANDS.set(key, value);
                    }
                }
            }
        } catch (e) {
            console.error('Error loading saved commands:', e);
        }
        
        // Check for GitHub sync and load data if enabled
        try {
            const syncEnabled = localStorage.getItem('syncEnabled') === 'true';
            const githubToken = localStorage.getItem('githubToken');
            const gistId = localStorage.getItem('gistId');
            
            if (syncEnabled && githubToken) {
                // Load from gist on startup
                loadFromGistOnStartup().catch(error => {
                    console.error('Error loading sync data on startup:', error);
                });
            }
        } catch (e) {
            console.error('Error checking sync status:', e);
        }
        
        // Apply saved theme with full settings
        try {
            const savedSettings = localStorage.getItem('homeSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                // Get theme name and dark mode setting
                const themeName = settings.theme || 'default';
                let isDarkMode = settings.darkMode || false;
                
                // Apply dark mode class
                document.documentElement.classList.toggle('dark-mode', isDarkMode);
                
                // Store theme data in a data attribute for commands component to access
                document.documentElement.dataset.theme = themeName;
                document.documentElement.dataset.darkMode = isDarkMode;
                
                // Update CONFIG with openLinksInNewTab setting
                CONFIG.openLinksInNewTab = settings.openLinksInNewTab || false;
                
                // Apply complete theme styling
                applyTheme(themeName, isDarkMode);
            }
        } catch (e) {
            console.error('Error loading theme settings:', e);
        }
        
        // Show the body after a short delay to ensure everything is rendered
        setTimeout(() => {
            document.body.classList.remove('loading');
        }, 100);
    });

    // Apply theme-appropriate background
    function updateBackgroundColor() {
        const themeName = document.documentElement.dataset.theme;
        const isDarkMode = document.documentElement.dataset.darkMode === 'true';
        
        if (themeName === 'mac' && !isDarkMode) {
            document.documentElement.style.backgroundColor = '#ffffff';
        } else if (themeName === 'mac' && isDarkMode) {
            document.documentElement.style.backgroundColor = '#000000';
        }
        document.documentElement.style.backgroundImage = 'none';
    }
    
    // Initial call
    updateBackgroundColor();
    
    // Listen for theme changes
    document.addEventListener('themeChanged', function(e) {
        updateBackgroundColor();
    });
    
    // Function to apply theme styling
    function applyTheme(themeName, isDarkMode) {
        // Define themes - must match settings.html themes
        const THEMES = {
            default: {
                light: {
                    background: '#f8f5e6',
                    gradient: 'linear-gradient(135deg, #f8f5e6, #f2edd0)',
                    text: '#222222',
                    textSubtle: '#666666',
                    accent: '#333333',
                    hover: '#444444',
                    boxShadow: '0 1px 4px rgba(0, 0, 0, 0.03)'
                },
                dark: {
                    background: '#1a1a1a',
                    gradient: 'linear-gradient(135deg, #222, #333)',
                    text: '#e0e0e0',
                    textSubtle: '#a0a0a0',
                    accent: '#505050',
                    hover: '#707070',
                    boxShadow: '0 1px 4px rgba(0, 0, 0, 0.2)'
                }
            },
            minimal: {
                light: {
                    background: '#ffffff',
                    gradient: 'none',
                    text: '#000000',
                    textSubtle: '#999999',
                    accent: '#cccccc',
                    hover: '#eeeeee',
                    boxShadow: 'none',
                    borderRadius: '0',
                    borderWidth: '0',
                    fontFamily: '"Courier New", monospace',
                    fontSize: '12px',
                    commandsBackground: 'transparent',
                    commandsBorder: 'none',
                    commandsBoxShadow: 'none',
                    commandMaxWidth: '70rem',
                    keyColor: '#666666'
                },
                dark: {
                    background: '#000000',
                    gradient: 'none',
                    text: '#ffffff',
                    textSubtle: '#777777',
                    accent: '#333333',
                    hover: '#222222',
                    boxShadow: 'none',
                    borderRadius: '0',
                    borderWidth: '0',
                    fontFamily: '"Courier New", monospace',
                    fontSize: '12px',
                    commandsBackground: 'transparent',
                    commandsBorder: 'none',
                    commandsBoxShadow: 'none',
                    commandMaxWidth: '70rem',
                    keyColor: '#999999'
                }
            },
            swiss: {
                light: {
                    background: '#ffffff',
                    gradient: 'none',
                    text: '#111111',
                    textSubtle: '#666666',
                    accent: '#ff3b30',
                    hover: '#ff6651',
                    boxShadow: 'none',
                    borderRadius: '0',
                    borderWidth: '0',
                    fontFamily: '"Helvetica Neue", Arial, sans-serif',
                    fontSize: '13px',
                    fontWeight: '300',
                    commandsBackground: 'transparent',
                    commandsBorder: 'none',
                    commandsBoxShadow: 'none',
                    commandMaxWidth: '80rem',
                    keyColor: '#ff3b30',
                    nameSpacing: '0.05em',
                    gridLayout: 'true',
                    letterSpacing: '0.03em',
                    keyFontSize: '1.1em',
                    keyWeight: '700',
                    nameAfterHeight: '0',
                    nameHoverColor: '#ff3b30'
                },
                dark: {
                    background: '#000000',
                    gradient: 'none',
                    text: '#ffffff',
                    textSubtle: '#999999',
                    accent: '#ff3b30',
                    hover: '#ff6651',
                    boxShadow: 'none',
                    borderRadius: '0',
                    borderWidth: '0',
                    fontFamily: '"Helvetica Neue", Arial, sans-serif',
                    fontSize: '13px',
                    fontWeight: '300',
                    commandsBackground: 'transparent',
                    commandsBorder: 'none',
                    commandsBoxShadow: 'none',
                    commandMaxWidth: '80rem',
                    keyColor: '#ff3b30',
                    nameSpacing: '0.05em',
                    gridLayout: 'true',
                    letterSpacing: '0.03em',
                    keyFontSize: '1.1em',
                    keyWeight: '700',
                    nameAfterHeight: '0',
                    nameHoverColor: '#ff3b30',
                    cornerTextTransform: 'uppercase',
                    cornerTextSpacing: '0.1em',
                    cornerTextWeight: '400',
                    cornerTextSize: '0.65rem'
                }
            },
            glass: {
                light: {
                    background: 'rgba(255, 255, 255, 0.7)',
                    gradient: 'linear-gradient(135deg, #f5f7fa, #c3cfe2)',
                    text: '#334155',
                    textSubtle: '#64748b',
                    accent: '#3b82f6',
                    hover: '#60a5fa',
                    boxShadow: '0 4px 20px rgba(0, 0, 0, 0.05)',
                    borderRadius: '16px',
                    commandsBackground: 'rgba(255, 255, 255, 0.6)',
                    commandsBorder: '1px solid rgba(255, 255, 255, 0.2)',
                    commandsBoxShadow: '0 8px 32px rgba(0, 0, 0, 0.07)',
                    fontFamily: '"Inter", -apple-system, BlinkMacSystemFont, sans-serif',
                    fontSize: '14px',
                    keyColor: '#3b82f6',
                    commandMaxWidth: '60rem',
                    backdropFilter: 'blur(10px)',
                    cornerTextStyle: 'text-transform: uppercase; letter-spacing: 0.1em; font-size: 0.6rem; font-weight: 500;',
                    dotSize: '6px',
                    dotOpacity: '0.7',
                    nameAfterHeight: '2px'
                },
                dark: {
                    background: 'rgba(15, 23, 42, 0.7)',
                    gradient: 'linear-gradient(135deg, #0f172a, #1e293b)',
                    text: '#e2e8f0',
                    textSubtle: '#94a3b8',
                    accent: '#38bdf8',
                    hover: '#7dd3fc',
                    boxShadow: '0 4px 20px rgba(0, 0, 0, 0.2)',
                    borderRadius: '16px',
                    commandsBackground: 'rgba(30, 41, 59, 0.5)',
                    commandsBorder: '1px solid rgba(255, 255, 255, 0.1)',
                    commandsBoxShadow: '0 8px 32px rgba(0, 0, 0, 0.2)',
                    fontFamily: '"Inter", -apple-system, BlinkMacSystemFont, sans-serif',
                    fontSize: '14px',
                    keyColor: '#38bdf8',
                    commandMaxWidth: '60rem',
                    backdropFilter: 'blur(10px)',
                    cornerTextStyle: 'text-transform: uppercase; letter-spacing: 0.1em; font-size: 0.6rem; font-weight: 500;',
                    dotSize: '6px',
                    dotOpacity: '0.7',
                    nameAfterHeight: '2px'
                }
            },
            ocean: {
                light: {
                    background: '#e0f7fa',
                    gradient: 'linear-gradient(135deg, #e0f7fa, #80deea 50%, #4dd0e1)',
                    text: '#006064',
                    textSubtle: '#0097a7',
                    accent: '#00838f',
                    hover: '#006064',
                    boxShadow: '0 4px 14px rgba(0, 131, 143, 0.15)',
                    borderRadius: '12px',
                    commandsBackground: 'rgba(224, 247, 250, 0.8)',
                    commandsBorder: '1px solid rgba(129, 212, 250, 0.4)',
                    commandsBoxShadow: '0 6px 24px rgba(0, 131, 143, 0.1)',
                    fontFamily: '"Inter", -apple-system, BlinkMacSystemFont, sans-serif',
                    fontSize: '14px',
                    keyColor: '#00acc1',
                    commandMaxWidth: '55rem',
                    backdropFilter: 'blur(8px)',
                    cornerTextStyle: 'font-style: italic; letter-spacing: 0.05em; font-size: 0.7rem;',
                    dotSize: '8px',
                    dotOpacity: '0.8',
                    nameAfterHeight: '2px',
                    nameFont: '500',
                    commandsColumns: '3',
                    inputBackground: 'rgba(224, 247, 250, 0.9)',
                    inputBorder: '1px solid rgba(129, 212, 250, 0.5)',
                    inputShadow: '0 2px 10px rgba(0, 131, 143, 0.1)',
                    uiAnimation: 'true',
                    cornerTextOpacity: '0.85'
                },
                dark: {
                    background: '#002f35',
                    gradient: 'linear-gradient(135deg, #002f35, #00363a 50%, #004d40)',
                    text: '#e0f7fa',
                    textSubtle: '#80deea',
                    accent: '#26c6da',
                    hover: '#4dd0e1',
                    boxShadow: '0 4px 14px rgba(0, 172, 193, 0.2)',
                    borderRadius: '12px',
                    commandsBackground: 'rgba(0, 59, 66, 0.7)',
                    commandsBorder: '1px solid rgba(38, 198, 218, 0.2)',
                    commandsBoxShadow: '0 6px 24px rgba(0, 172, 193, 0.15)',
                    fontFamily: '"Inter", -apple-system, BlinkMacSystemFont, sans-serif',
                    fontSize: '14px',
                    keyColor: '#26c6da',
                    commandMaxWidth: '55rem',
                    backdropFilter: 'blur(8px)',
                    cornerTextStyle: 'font-style: italic; letter-spacing: 0.05em; font-size: 0.7rem;',
                    dotSize: '8px',
                    dotOpacity: '0.8',
                    nameAfterHeight: '2px',
                    nameFont: '500',
                    commandsColumns: '3',
                    inputBackground: 'rgba(0, 59, 66, 0.8)',
                    inputBorder: '1px solid rgba(38, 198, 218, 0.3)',
                    inputShadow: '0 2px 10px rgba(0, 172, 193, 0.15)',
                    uiAnimation: 'true',
                    cornerTextOpacity: '0.85'
                }
            },
            // New themes added below
            neon: {
                light: {
                    background: '#0f0f1a',
                    gradient: 'radial-gradient(circle at top right, rgba(120, 0, 255, 0.2), transparent), radial-gradient(circle at bottom left, rgba(0, 255, 255, 0.2), transparent)',
                    text: '#ffffff',
                    textSubtle: '#a0a0c0',
                    accent: '#ff00aa',
                    hover: '#ff4dcd',
                    boxShadow: '0 0 20px rgba(255, 0, 170, 0.3)',
                    borderRadius: '8px',
                    commandsBackground: 'rgba(15, 15, 30, 0.7)',
                    commandsBorder: '1px solid rgba(255, 0, 170, 0.3)',
                    commandsBoxShadow: '0 0 15px rgba(255, 0, 170, 0.2)',
                    fontFamily: '"Inter", -apple-system, BlinkMacSystemFont, sans-serif',
                    fontSize: '14px',
                    keyColor: '#ff00aa',
                    commandMaxWidth: '60rem',
                    backdropFilter: 'blur(5px)',
                    cornerTextStyle: 'letter-spacing: 0.05em; font-size: 0.7rem; font-weight: 400;',
                    dotSize: '6px',
                    dotOpacity: '0.9',
                    nameAfterHeight: '2px',
                    nameHoverColor: '#ff00aa',
                    uiAnimation: 'true',
                    cornerTextOpacity: '0.8',
                    textGlow: 'true',
                    textGlowColor: 'rgba(255, 0, 170, 0.7)',
                    keyHoverGlow: 'true'
                },
                dark: {
                    background: '#0a0a12',
                    gradient: 'radial-gradient(circle at top right, rgba(120, 0, 255, 0.3), transparent), radial-gradient(circle at bottom left, rgba(0, 255, 255, 0.3), transparent)',
                    text: '#ffffff',
                    textSubtle: '#a0a0c0',
                    accent: '#00eeff',
                    hover: '#4df4ff',
                    boxShadow: '0 0 20px rgba(0, 238, 255, 0.3)',
                    borderRadius: '8px',
                    commandsBackground: 'rgba(10, 10, 20, 0.7)',
                    commandsBorder: '1px solid rgba(0, 238, 255, 0.3)',
                    commandsBoxShadow: '0 0 15px rgba(0, 238, 255, 0.2)',
                    fontFamily: '"Inter", -apple-system, BlinkMacSystemFont, sans-serif',
                    fontSize: '14px',
                    keyColor: '#00eeff',
                    commandMaxWidth: '60rem',
                    backdropFilter: 'blur(5px)',
                    cornerTextStyle: 'letter-spacing: 0.05em; font-size: 0.7rem; font-weight: 400;',
                    dotSize: '6px',
                    dotOpacity: '0.9',
                    nameAfterHeight: '2px',
                    nameHoverColor: '#00eeff',
                    uiAnimation: 'true',
                    cornerTextOpacity: '0.8',
                    textGlow: 'true',
                    textGlowColor: 'rgba(0, 238, 255, 0.7)',
                    keyHoverGlow: 'true'
                }
            },
            retro: {
                light: {
                    background: '#faf4d4',
                    gradient: 'linear-gradient(135deg, #faf4d4, #f9c58d)',
                    text: '#562349',
                    textSubtle: '#813772',
                    accent: '#ca5fa6',
                    hover: '#dc92c3',
                    boxShadow: '3px 3px 0 rgba(86, 35, 73, 0.2)',
                    borderRadius: '0px',
                    commandsBackground: 'rgba(250, 244, 212, 0.9)',
                    commandsBorder: '2px solid #562349',
                    commandsBoxShadow: '4px 4px 0 rgba(86, 35, 73, 0.2)',
                    fontFamily: '"Space Grotesk", "Courier New", monospace',
                    fontSize: '14px',
                    keyColor: '#ca5fa6',
                    commandMaxWidth: '60rem',
                    cornerTextStyle: 'font-family: "Space Grotesk", monospace; letter-spacing: 0.1em; font-size: 0.7rem; font-weight: 500;',
                    dotSize: '8px',
                    dotOpacity: '0.9',
                    nameAfterHeight: '0px',
                    borderStyle: 'solid',
                    borderWidth: '2px',
                    borderColor: '#562349',
                    uiAnimation: 'true',
                    fontWeight: '500',
                    keyFontSize: '1.2em'
                },
                dark: {
                    background: '#2c1320',
                    gradient: 'linear-gradient(135deg, #2c1320, #42253b)',
                    text: '#f9c58d',
                    textSubtle: '#dd9e6c',
                    accent: '#f4b674',
                    hover: '#f7d4a6',
                    boxShadow: '3px 3px 0 rgba(244, 182, 116, 0.2)',
                    borderRadius: '0px',
                    commandsBackground: 'rgba(44, 19, 32, 0.9)',
                    commandsBorder: '2px solid #f4b674',
                    commandsBoxShadow: '4px 4px 0 rgba(244, 182, 116, 0.2)',
                    fontFamily: '"Space Grotesk", "Courier New", monospace',
                    fontSize: '14px',
                    keyColor: '#f4b674',
                    commandMaxWidth: '60rem',
                    cornerTextStyle: 'font-family: "Space Grotesk", monospace; letter-spacing: 0.1em; font-size: 0.7rem; font-weight: 500;',
                    dotSize: '8px',
                    dotOpacity: '0.9',
                    nameAfterHeight: '0px',
                    borderStyle: 'solid',
                    borderWidth: '2px',
                    borderColor: '#f4b674',
                    uiAnimation: 'true',
                    fontWeight: '500',
                    keyFontSize: '1.2em'
                }
            },
            brutalist: {
                light: {
                    background: '#ffffff',
                    gradient: 'none',
                    text: '#000000',
                    textSubtle: '#444444',
                    accent: '#000000',
                    hover: '#333333',
                    boxShadow: 'none',
                    borderRadius: '0',
                    commandsBackground: 'transparent',
                    commandsBorder: '1px solid #000000',
                    commandsBoxShadow: 'none',
                    fontFamily: '"Helvetica Neue", Arial, sans-serif',
                    fontSize: '16px',
                    fontWeight: '400',
                    keyColor: '#000000',
                    commandMaxWidth: '100%',
                    cornerTextStyle: 'text-transform: uppercase; letter-spacing: 0.05em; font-size: 0.8rem; font-weight: 700;',
                    nameAfterHeight: '0',
                    gridLayout: 'true',
                    layoutType: 'grid',
                    borderStyle: 'solid',
                    borderWidth: '1px',
                    borderColor: '#000000',
                    commandPadding: '0.5rem'
                },
                dark: {
                    background: '#000000',
                    gradient: 'none',
                    text: '#ffffff',
                    textSubtle: '#bbbbbb',
                    accent: '#ffffff',
                    hover: '#cccccc',
                    boxShadow: 'none',
                    borderRadius: '0',
                    commandsBackground: 'transparent',
                    commandsBorder: '1px solid #ffffff',
                    commandsBoxShadow: 'none',
                    fontFamily: '"Helvetica Neue", Arial, sans-serif',
                    fontSize: '16px',
                    fontWeight: '400',
                    keyColor: '#ffffff',
                    commandMaxWidth: '100%',
                    cornerTextStyle: 'text-transform: uppercase; letter-spacing: 0.05em; font-size: 0.8rem; font-weight: 700;',
                    nameAfterHeight: '0',
                    gridLayout: 'true',
                    layoutType: 'grid',
                    borderStyle: 'solid',
                    borderWidth: '1px',
                    borderColor: '#ffffff',
                    commandPadding: '0.5rem'
                }
            },
            gaming: {
                light: {
                    background: '#121212',
                    gradient: 'linear-gradient(135deg, #121212, #1a1a1a)',
                    text: '#e0e0e0',
                    textSubtle: '#a0a0a0',
                    accent: '#00ff66',
                    hover: '#33ff85',
                    boxShadow: '0 0 10px rgba(0, 255, 102, 0.2)',
                    borderRadius: '4px',
                    commandsBackground: 'rgba(26, 26, 26, 0.9)',
                    commandsBorder: '1px solid rgba(0, 255, 102, 0.3)',
                    commandsBoxShadow: '0 0 15px rgba(0, 255, 102, 0.15)',
                    fontFamily: '"Exo 2", "Inter", sans-serif',
                    fontSize: '14px',
                    keyColor: '#00ff66',
                    commandMaxWidth: '65rem',
                    cornerTextStyle: 'font-family: "Exo 2", sans-serif; text-transform: uppercase; letter-spacing: 0.1em; font-size: 0.7rem; font-weight: 600;',
                    dotSize: '5px',
                    dotOpacity: '0.9',
                    nameAfterHeight: '1px',
                    uiAnimation: 'true',
                    keyFontSize: '1em',
                    keyStyle: 'border: 1px solid rgba(0, 255, 102, 0.3); padding: 2px 6px; border-radius: 2px;'
                },
                dark: {
                    background: '#0a0a0a',
                    gradient: 'linear-gradient(135deg, #0a0a0a, #151515)',
                    text: '#e0e0e0',
                    textSubtle: '#a0a0a0',
                    accent: '#00ff66',
                    hover: '#33ff85',
                    boxShadow: '0 0 10px rgba(0, 255, 102, 0.2)',
                    borderRadius: '4px',
                    commandsBackground: 'rgba(15, 15, 15, 0.9)',
                    commandsBorder: '1px solid rgba(0, 255, 102, 0.3)',
                    commandsBoxShadow: '0 0 15px rgba(0, 255, 102, 0.15)',
                    fontFamily: '"Exo 2", "Inter", sans-serif',
                    fontSize: '14px',
                    keyColor: '#00ff66',
                    commandMaxWidth: '65rem',
                    cornerTextStyle: 'font-family: "Exo 2", sans-serif; text-transform: uppercase; letter-spacing: 0.1em; font-size: 0.7rem; font-weight: 600;',
                    dotSize: '5px',
                    dotOpacity: '0.9',
                    nameAfterHeight: '1px',
                    uiAnimation: 'true',
                    keyFontSize: '1em',
                    keyStyle: 'border: 1px solid rgba(0, 255, 102, 0.3); padding: 2px 6px; border-radius: 2px;'
                }
            },
            cyberpunk: {
                light: {
                    background: '#0c0c14',
                    gradient: 'linear-gradient(135deg, #0c0c14, #0f1023), radial-gradient(at top right, rgba(255, 30, 86, 0.3), transparent 70%), radial-gradient(at bottom left, rgba(0, 255, 230, 0.3), transparent 70%)',
                    text: '#f2f2f2',
                    textSubtle: '#aaaacc',
                    accent: '#ff1e56',
                    hover: '#ff4d79',
                    boxShadow: '0 0 20px rgba(255, 30, 86, 0.2)',
                    borderRadius: '2px',
                    commandsBackground: 'rgba(12, 12, 20, 0.7)',
                    commandsBorder: '1px solid rgba(255, 30, 86, 0.3)',
                    commandsBoxShadow: '0 0 30px rgba(255, 30, 86, 0.15)',
                    fontFamily: '"Rajdhani", "Orbitron", sans-serif',
                    fontSize: '14px',
                    fontWeight: '500',
                    keyColor: '#00ffe6',
                    commandMaxWidth: '70rem',
                    cornerTextStyle: 'font-family: "Rajdhani", sans-serif; text-transform: uppercase; letter-spacing: 0.12em; font-size: 0.7rem; font-weight: 600;',
                    dotSize: '5px',
                    dotOpacity: '0.9',
                    nameAfterHeight: '2px',
                    uiAnimation: 'true',
                    keyFontSize: '1em',
                    keyStyle: 'border-left: 2px solid #00ffe6; border-bottom: 2px solid #00ffe6; padding: 2px 6px; border-radius: 0; text-shadow: 0 0 5px rgba(0, 255, 230, 0.8);',
                    layoutType: 'cyberpunk-grid',
                    textGlow: 'true',
                    textGlowColor: 'rgba(0, 255, 230, 0.8)',
                    keyHoverGlow: 'true',
                    glitchEffect: 'true',
                    nameHoverColor: '#00ffe6',
                    cornerTextShadow: '0 0 8px rgba(255, 30, 86, 0.8)',
                    backgroundNoise: 'true',
                    gridGaps: 'true',
                    commandPadding: '0.8rem'
                },
                dark: {
                    background: '#080810',
                    gradient: 'linear-gradient(135deg, #080810, #0a0a18), radial-gradient(at top right, rgba(255, 30, 86, 0.4), transparent 70%), radial-gradient(at bottom left, rgba(0, 255, 230, 0.4), transparent 70%)',
                    text: '#f2f2f2',
                    textSubtle: '#aaaacc',
                    accent: '#00ffe6',
                    hover: '#66fff0',
                    boxShadow: '0 0 20px rgba(0, 255, 230, 0.2)',
                    borderRadius: '2px',
                    commandsBackground: 'rgba(8, 8, 16, 0.7)',
                    commandsBorder: '1px solid rgba(0, 255, 230, 0.3)',
                    commandsBoxShadow: '0 0 30px rgba(0, 255, 230, 0.15)',
                    fontFamily: '"Rajdhani", "Orbitron", sans-serif',
                    fontSize: '14px',
                    fontWeight: '500',
                    keyColor: '#ff1e56',
                    commandMaxWidth: '70rem',
                    cornerTextStyle: 'font-family: "Rajdhani", sans-serif; text-transform: uppercase; letter-spacing: 0.12em; font-size: 0.7rem; font-weight: 600;',
                    dotSize: '5px',
                    dotOpacity: '0.9',
                    nameAfterHeight: '2px',
                    uiAnimation: 'true',
                    keyFontSize: '1em',
                    keyStyle: 'border-left: 2px solid #ff1e56; border-bottom: 2px solid #ff1e56; padding: 2px 6px; border-radius: 0; text-shadow: 0 0 5px rgba(255, 30, 86, 0.8);',
                    layoutType: 'cyberpunk-grid',
                    textGlow: 'true',
                    textGlowColor: 'rgba(255, 30, 86, 0.8)',
                    keyHoverGlow: 'true',
                    glitchEffect: 'true',
                    nameHoverColor: '#ff1e56',
                    cornerTextShadow: '0 0 8px rgba(0, 255, 230, 0.8)',
                    backgroundNoise: 'true',
                    gridGaps: 'true',
                    commandPadding: '0.8rem'
                }
            },
            bauhaus: {
                light: {
                    background: '#ffffff',
                    gradient: 'radial-gradient(circle at center, #ffffff 50%, #f0f0f0 100%)',
                    text: '#000000',
                    textSubtle: '#555555',
                    accent: '#E40303',
                    hover: '#FF5555',
                    boxShadow: 'none',
                    borderRadius: '0',
                    commandsBackground: 'transparent',
                    commandsBorder: '2px solid #000000',
                    commandsBoxShadow: 'none',
                    fontFamily: '"Futura PT", "Bauhaus 93", sans-serif',
                    fontSize: '14px',
                    fontWeight: '500',
                    keyColor: '#0087CC',
                    commandMaxWidth: '90%',
                    cornerTextStyle: 'font-family: "Futura PT", sans-serif; text-transform: uppercase; letter-spacing: 0.2em; font-size: 0.8rem; font-weight: 700;',
                    dotSize: '10px',
                    dotOpacity: '1',
                    nameAfterHeight: '0',
                    keyFontSize: '1.2em',
                    layoutType: 'bauhaus-grid',
                    borderStyle: 'solid',
                    borderWidth: '2px',
                    borderColor: '#000000',
                    geometricShapes: 'true',
                    colorBlocks: 'true',
                    cornerSymbols: 'true',
                    keyStyle: 'background-color: #FFD700; color: #000000; padding: 2px 6px; font-weight: bold;',
                    nameStyle: 'text-transform: uppercase; font-weight: 600;',
                    primaryColor: '#E40303',
                    secondaryColor: '#0087CC',
                    tertiaryColor: '#FFD700',
                    gridLayout: 'true',
                    commandCascade: 'true',
                    commandPadding: '1.2rem'
                },
                dark: {
                    background: '#121212',
                    gradient: 'radial-gradient(circle at center, #121212 50%, #0a0a0a 100%)',
                    text: '#ffffff',
                    textSubtle: '#aaaaaa',
                    accent: '#E40303',
                    hover: '#FF5555',
                    boxShadow: 'none',
                    borderRadius: '0',
                    commandsBackground: 'transparent',
                    commandsBorder: '2px solid #ffffff',
                    commandsBoxShadow: 'none',
                    fontFamily: '"Futura PT", "Bauhaus 93", sans-serif',
                    fontSize: '14px',
                    fontWeight: '500',
                    keyColor: '#0087CC',
                    commandMaxWidth: '90%',
                    cornerTextStyle: 'font-family: "Futura PT", sans-serif; text-transform: uppercase; letter-spacing: 0.2em; font-size: 0.8rem; font-weight: 700;',
                    dotSize: '10px',
                    dotOpacity: '1',
                    nameAfterHeight: '0',
                    keyFontSize: '1.2em',
                    layoutType: 'bauhaus-grid',
                    borderStyle: 'solid',
                    borderWidth: '2px',
                    borderColor: '#ffffff',
                    geometricShapes: 'true',
                    colorBlocks: 'true',
                    cornerSymbols: 'true',
                    keyStyle: 'background-color: #FFD700; color: #000000; padding: 2px 6px; font-weight: bold;',
                    nameStyle: 'text-transform: uppercase; font-weight: 600;',
                    primaryColor: '#E40303',
                    secondaryColor: '#0087CC',
                    tertiaryColor: '#FFD700',
                    gridLayout: 'true',
                    commandCascade: 'true',
                    commandPadding: '1.2rem'
                }
            },
            vaporwave: {
                light: {
                    background: '#c6a4f2',
                    gradient: 'linear-gradient(135deg, #c6a4f2, #fd7ab8), radial-gradient(at top right, rgba(117, 255, 225, 0.7), transparent)',
                    text: '#1f0033',
                    textSubtle: '#4e2f6b',
                    accent: '#fd7ab8',
                    hover: '#ffb5d8',
                    boxShadow: '0 5px 15px rgba(198, 164, 242, 0.4)',
                    borderRadius: '0px',
                    commandsBackground: 'rgba(255, 255, 255, 0.15)',
                    commandsBorder: '1px solid rgba(255, 255, 255, 0.3)',
                    commandsBoxShadow: '0 8px 32px rgba(253, 122, 184, 0.2)',
                    fontFamily: '"VT323", "Windows Command Prompt", monospace',
                    fontSize: '16px',
                    fontWeight: '400',
                    keyColor: '#75ffe1',
                    commandMaxWidth: '60rem',
                    cornerTextStyle: 'font-family: "VT323", monospace; font-size: 1rem; letter-spacing: 0.05em;',
                    dotSize: '8px',
                    dotOpacity: '1',
                    nameAfterHeight: '0',
                    uiAnimation: 'true',
                    keyFontSize: '1.2em',
                    keyStyle: 'border: none; background-color: rgba(117, 255, 225, 0.3); padding: 2px 8px;',
                    gridGaps: 'true',
                    retroShadows: 'true',
                    pixelatedEdges: 'true',
                    glowEffect: 'true',
                    scanlines: 'true',
                    chromaticAberration: 'true',
                    retro3d: 'true',
                    sunsetGradient: 'true',
                    nameStyle: 'font-size: 1em;',
                    commandPadding: '1.2rem',
                    gridLayout: 'true'
                },
                dark: {
                    background: '#2d1259',
                    gradient: 'linear-gradient(135deg, #2d1259, #5b2180), radial-gradient(at top right, rgba(255, 182, 193, 0.4), transparent)',
                    text: '#fbceff',
                    textSubtle: '#d1a6f7',
                    accent: '#75ffe1',
                    hover: '#a0ffeb',
                    boxShadow: '0 5px 15px rgba(117, 255, 225, 0.3)',
                    borderRadius: '0px',
                    commandsBackground: 'rgba(45, 18, 89, 0.7)',
                    commandsBorder: '1px solid rgba(117, 255, 225, 0.3)',
                    commandsBoxShadow: '0 8px 32px rgba(117, 255, 225, 0.2)',
                    fontFamily: '"VT323", "Windows Command Prompt", monospace',
                    fontSize: '16px',
                    fontWeight: '400',
                    keyColor: '#fd7ab8',
                    commandMaxWidth: '60rem',
                    cornerTextStyle: 'font-family: "VT323", monospace; font-size: 1rem; letter-spacing: 0.05em;',
                    dotSize: '8px',
                    dotOpacity: '1',
                    nameAfterHeight: '0',
                    uiAnimation: 'true',
                    keyFontSize: '1.2em',
                    keyStyle: 'border: none; background-color: rgba(253, 122, 184, 0.3); padding: 2px 8px;',
                    gridGaps: 'true',
                    retroShadows: 'true',
                    pixelatedEdges: 'true',
                    glowEffect: 'true',
                    scanlines: 'true',
                    chromaticAberration: 'true',
                    retro3d: 'true',
                    sunsetGradient: 'true',
                    nameStyle: 'font-size: 1em;',
                    commandPadding: '1.2rem',
                    gridLayout: 'true'
                }
            },
            nordic: {
                light: {
                    background: '#f8f9fa',
                    gradient: 'linear-gradient(135deg, #f8f9fa, #e9ecef)',
                    text: '#212529',
                    textSubtle: '#6c757d',
                    accent: '#5e81ac',
                    hover: '#81a1c1',
                    boxShadow: '0 2px 10px rgba(94, 129, 172, 0.1)',
                    borderRadius: '8px',
                    commandsBackground: 'rgba(248, 249, 250, 0.7)',
                    commandsBorder: '1px solid rgba(222, 226, 230, 0.8)',
                    commandsBoxShadow: '0 4px 12px rgba(222, 226, 230, 0.5)',
                    fontFamily: '"Inter", "system-ui", sans-serif',
                    fontSize: '14px',
                    fontWeight: '400',
                    keyColor: '#5e81ac',
                    commandMaxWidth: '50rem',
                    cornerTextStyle: 'font-family: "Inter", sans-serif; font-size: 0.75rem; font-weight: 500;',
                    dotSize: '4px',
                    dotOpacity: '0.7',
                    nameAfterHeight: '1px',
                    commandsColumns: '4',
                    borderWidth: '0',
                    borderStyle: 'none',
                    nameSpacing: '0.02em',
                    letterSpacing: '0.01em',
                    keyWeight: '500',
                    nameFont: '400',
                    keyFontSize: '0.9em',
                    commandPadding: '1.5rem',
                    inputBackground: 'rgba(248, 249, 250, 0.9)',
                    inputBorder: '1px solid rgba(222, 226, 230, 0.8)',
                    inputShadow: '0 2px 5px rgba(94, 129, 172, 0.1)',
                    subtleTransitions: 'true',
                    commandsSpacing: '2.2rem'
                },
                dark: {
                    background: '#212529',
                    gradient: 'linear-gradient(135deg, #212529, #343a40)',
                    text: '#e9ecef',
                    textSubtle: '#adb5bd',
                    accent: '#88c0d0',
                    hover: '#8fbcbb',
                    boxShadow: '0 2px 10px rgba(136, 192, 208, 0.1)',
                    borderRadius: '8px',
                    commandsBackground: 'rgba(33, 37, 41, 0.7)',
                    commandsBorder: '1px solid rgba(52, 58, 64, 0.8)',
                    commandsBoxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',
                    fontFamily: '"Inter", "system-ui", sans-serif',
                    fontSize: '14px',
                    fontWeight: '400',
                    keyColor: '#88c0d0',
                    commandMaxWidth: '50rem',
                    cornerTextStyle: 'font-family: "Inter", sans-serif; font-size: 0.75rem; font-weight: 500;',
                    dotSize: '4px',
                    dotOpacity: '0.7',
                    nameAfterHeight: '1px',
                    commandsColumns: '4',
                    borderWidth: '0',
                    borderStyle: 'none',
                    nameSpacing: '0.02em',
                    letterSpacing: '0.01em',
                    keyWeight: '500',
                    nameFont: '400',
                    keyFontSize: '0.9em',
                    commandPadding: '1.5rem',
                    inputBackground: 'rgba(33, 37, 41, 0.9)',
                    inputBorder: '1px solid rgba(52, 58, 64, 0.8)',
                    inputShadow: '0 2px 5px rgba(0, 0, 0, 0.15)',
                    subtleTransitions: 'true',
                    commandsSpacing: '2.2rem'
                }
            },
            mac: {
                light: {
                    background: '#ffffff',
                    gradient: 'none',
                    text: '#1d1d1f',
                    textSubtle: '#86868b',
                    accent: '#0071e3',
                    hover: '#0077ed',
                    boxShadow: '0 2px 6px rgba(0, 0, 0, 0.03)',
                    borderRadius: '8px',
                    commandsBackground: 'rgba(255, 255, 255, 0.8)',
                    commandsBorder: '1px solid rgba(0, 0, 0, 0.05)',
                    commandsBoxShadow: '0 10px 20px rgba(0, 0, 0, 0.05)',
                    fontFamily: '-apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif',
                    fontSize: '14px',
                    fontWeight: '500',
                    keyColor: '#1d1d1f',
                    commandMaxWidth: '70rem',
                    cornerTextStyle: 'font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif; letter-spacing: -0.01em; font-size: 0.75rem; font-weight: 400; opacity: 0.7;',
                    dotSize: '4px',
                    dotOpacity: '0.1',
                    nameAfterHeight: '0px',
                    gridGap: '1.5rem',
                    minimalInterface: 'true',
                    subtleTransitions: 'true',
                    cleanSpacing: 'true',
                    keyStyle: 'background: linear-gradient(to bottom, #f7f7f7, #e2e2e2); border: 1px solid #d1d1d1; box-shadow: 0 1px 2px rgba(0,0,0,0.05), 0 -1px 0 rgba(255,255,255,0.5) inset, 0 1px 0 rgba(0,0,0,0.1); color: #1d1d1f; font-weight: 500; transform: translateY(0); transition: all 0.1s ease; position: relative; text-shadow: 0 1px 0 rgba(255,255,255,0.5);',
                    keyHoverStyle: 'transform: translateY(-1px); box-shadow: 0 2px 3px rgba(0,0,0,0.07), 0 -1px 0 rgba(255,255,255,0.5) inset, 0 1px 0 rgba(0,0,0,0.1);',
                    keyActiveStyle: 'transform: translateY(1px); box-shadow: 0 0 1px rgba(0,0,0,0.1), 0 -1px 0 rgba(255,255,255,0.5) inset, 0 1px 0 rgba(0,0,0,0.1);',
                    nameHoverColor: '#0071e3',
                    keycapStyle: 'true',
                    key3D: 'true',
                    keyFontSize: '0.9em',
                    keyBorderRadius: '4px',
                    keyPadding: '6px 8px',
                    keyHeight: '30px',
                    keyWidth: '30px',
                    keyVerticalAlign: 'middle',
                    macKeyboardEffect: 'true',
                    keyTextAlign: 'center',
                    inputStyle: 'border-radius: 8px; border: 1px solid rgba(0, 0, 0, 0.1); padding: 8px 12px; background: rgba(255, 255, 255, 0.8);',
                    commandsColumns: '4',
                    commandPadding: '1.5rem'
                },
                dark: {
                    background: '#000000',
                    gradient: 'none',
                    text: '#f5f5f7',
                    textSubtle: '#86868b',
                    accent: '#0077ed',
                    hover: '#0284ff',
                    boxShadow: '0 2px 6px rgba(0, 0, 0, 0.15)',
                    borderRadius: '8px',
                    commandsBackground: 'rgba(28, 28, 30, 0.8)',
                    commandsBorder: '1px solid rgba(255, 255, 255, 0.05)',
                    commandsBoxShadow: '0 10px 20px rgba(0, 0, 0, 0.15)',
                    fontFamily: '-apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif',
                    fontSize: '14px',
                    fontWeight: '500',
                    keyColor: '#f5f5f7',
                    commandMaxWidth: '70rem',
                    cornerTextStyle: 'font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif; letter-spacing: -0.01em; font-size: 0.75rem; font-weight: 400; opacity: 0.7;',
                    dotSize: '4px',
                    dotOpacity: '0.2',
                    nameAfterHeight: '0px',
                    gridGap: '1.5rem',
                    minimalInterface: 'true',
                    subtleTransitions: 'true',
                    cleanSpacing: 'true',
                    keyStyle: 'background: linear-gradient(to bottom, #3a3a3c, #2c2c2e); border: 1px solid #1c1c1e; box-shadow: 0 1px 2px rgba(0,0,0,0.2), 0 -1px 0 rgba(255,255,255,0.1) inset, 0 1px 0 rgba(0,0,0,0.2); color: #f5f5f7; font-weight: 500; transform: translateY(0); transition: all 0.1s ease; position: relative; text-shadow: 0 1px 1px rgba(0,0,0,0.2);',
                    keyHoverStyle: 'transform: translateY(-1px); box-shadow: 0 2px 3px rgba(0,0,0,0.3), 0 -1px 0 rgba(255,255,255,0.1) inset, 0 1px 0 rgba(0,0,0,0.2);',
                    keyActiveStyle: 'transform: translateY(1px); box-shadow: 0 0 1px rgba(0,0,0,0.3), 0 -1px 0 rgba(255,255,255,0.1) inset, 0 1px 0 rgba(0,0,0,0.2);',
                    nameHoverColor: '#0077ed',
                    keycapStyle: 'true',
                    key3D: 'true',
                    keyFontSize: '0.9em',
                    keyBorderRadius: '4px',
                    keyPadding: '6px 8px',
                    keyHeight: '30px',
                    keyWidth: '30px',
                    keyVerticalAlign: 'middle',
                    macKeyboardEffect: 'true',
                    keyTextAlign: 'center',
                    inputStyle: 'border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1); padding: 8px 12px; background: rgba(28, 28, 30, 0.8);',
                    commandsColumns: '4',
                    commandPadding: '1.5rem'
                }
            }
        };
        
        // Get theme and colors
        const theme = THEMES[themeName] || THEMES.default;
        const colors = isDarkMode ? theme.dark : theme.light;
        
        // Apply basic colors
        document.documentElement.style.setProperty('--color-background', colors.background);
        document.documentElement.style.setProperty('--color-text', colors.text);
        document.documentElement.style.setProperty('--color-text-subtle', colors.textSubtle);
        document.documentElement.style.setProperty('--color-accent', colors.accent);
        document.documentElement.style.setProperty('--color-hover', colors.hover);
        document.documentElement.style.setProperty('--box-shadow', colors.boxShadow);
        
        // Apply gradient
        if (colors.gradient && colors.gradient !== 'none') {
            document.documentElement.style.backgroundImage = colors.gradient;
        } else {
            document.documentElement.style.backgroundImage = 'none';
        }
        
        // Apply additional theme-specific styles
        if (colors.borderRadius) {
            document.documentElement.style.setProperty('--border-radius', colors.borderRadius);
        } else {
            document.documentElement.style.setProperty('--border-radius', '8px');
        }
        
        if (colors.fontFamily) {
            document.documentElement.style.fontFamily = colors.fontFamily;
        } else {
            document.documentElement.style.fontFamily = 'var(--font-family)';
        }
        
        if (colors.fontSize) {
            document.documentElement.style.fontSize = colors.fontSize;
        } else {
            document.documentElement.style.fontSize = 'var(--font-size)';
        }
        
        // Apply advanced CSS features
        if (colors.textGlow === 'true') {
            const glowColor = colors.textGlowColor || `rgba(${parseInt(colors.accent.slice(1, 3), 16)}, ${parseInt(colors.accent.slice(3, 5), 16)}, ${parseInt(colors.accent.slice(5, 7), 16)}, 0.7)`;
            const textGlowStyle = document.createElement('style');
            textGlowStyle.id = 'text-glow-style';
            textGlowStyle.textContent = `
                .command-key {
                    text-shadow: 0 0 10px ${glowColor};
                }
                .command-name:hover {
                    text-shadow: 0 0 8px ${glowColor};
                }
            `;
            document.head.appendChild(textGlowStyle);
        } else {
            const existingGlowStyle = document.getElementById('text-glow-style');
            if (existingGlowStyle) existingGlowStyle.remove();
        }
        
        // Apply special theme effects
        // Cyberpunk theme effects
        if (themeName === 'cyberpunk') {
            const cyberpunkStyle = document.createElement('style');
            cyberpunkStyle.id = 'cyberpunk-style';
            cyberpunkStyle.textContent = `
                @keyframes glitch {
                    0% { transform: translate(0); }
                    20% { transform: translate(-2px, 2px); }
                    40% { transform: translate(-2px, -2px); }
                    60% { transform: translate(2px, 2px); }
                    80% { transform: translate(2px, -2px); }
                    100% { transform: translate(0); }
                }
                
                @keyframes scanline {
                    0% { background-position: 0 0; }
                    100% { background-position: 0 100%; }
                }
                
                html {
                    position: relative;
                }
                
                html::before {
                    content: "";
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWNgYGBgYHB3d/8PAAQVAZm5mWUTAAAAAElFTkSuQmCC");
                    background-repeat: repeat;
                    pointer-events: none;
                    opacity: 0.03;
                    z-index: 1000;
                }
                
                .command-key {
                    position: relative;
                    overflow: hidden;
                }
                
                .command-key::before {
                    content: attr(data-text);
                    position: absolute;
                    left: 0;
                    top: 0;
                    color: rgba(255, 30, 86, 0.8);
                    width: 100%;
                    clip: rect(44px, 450px, 56px, 0);
                    overflow: hidden;
                    height: 100%;
                }
                
                .command-key:hover::before {
                    animation: glitch 0.3s linear 0.3s forwards;
                }
                
                .corner-text {
                    text-shadow: ${isDarkMode ? '0 0 8px rgba(0, 255, 230, 0.8)' : '0 0 8px rgba(255, 30, 86, 0.8)'};
                }
                
                .commands {
                    position: relative;
                    grid-gap: 1px !important;
                }
                
                .commands::after {
                    content: "";
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: linear-gradient(
                        to bottom,
                        transparent 50%,
                        rgba(0, 0, 0, 0.05) 51%,
                        transparent 52%
                    );
                    background-size: 100% 4px;
                    pointer-events: none;
                    animation: scanline 10s linear infinite;
                    opacity: 0.15;
                }
            `;
            document.head.appendChild(cyberpunkStyle);
            
            // Set data-text attribute for glitch effect
            const keys = document.querySelectorAll('.command-key');
            keys.forEach(key => {
                key.setAttribute('data-text', key.textContent);
            });
        } else {
            const existingCyberpunkStyle = document.getElementById('cyberpunk-style');
            if (existingCyberpunkStyle) existingCyberpunkStyle.remove();
        }
        
        // Bauhaus theme effects
        if (themeName === 'bauhaus') {
            const bauhausStyle = document.createElement('style');
            bauhausStyle.id = 'bauhaus-style';
            bauhausStyle.textContent = `
                .commands {
                    display: grid !important;
                    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)) !important;
                    grid-gap: 1.5rem !important;
                    grid-auto-flow: dense !important;
                    padding: 2rem !important;
                    position: relative !important;
                }
                
                .command {
                    display: flex !important;
                    flex-direction: column !important;
                    align-items: center !important;
                    justify-content: center !important;
                    text-align: center !important;
                    padding: 1.5rem 0.5rem !important;
                    position: relative !important;
                    z-index: 1 !important;
                    border: 2px solid ${isDarkMode ? '#ffffff' : '#000000'} !important;
                }
                
                .command::before {
                    content: "";
                    position: absolute;
                    z-index: -1;
                    width: 20px;
                    height: 20px;
                    border-radius: 50%;
                    background-color: ${isDarkMode ? '#E40303' : '#E40303'};
                    right: -10px;
                    top: -10px;
                }
                
                .command:nth-child(3n)::before {
                    background-color: ${isDarkMode ? '#0087CC' : '#0087CC'};
                    width: 30px;
                    height: 6px;
                    border-radius: 0;
                    right: -15px;
                    top: 50%;
                    transform: translateY(-50%);
                }
                
                .command:nth-child(3n+1)::before {
                    background-color: ${isDarkMode ? '#FFD700' : '#FFD700'};
                    border-radius: 0;
                    width: 15px;
                    height: 15px;
                    transform: rotate(45deg);
                }
                
                .command:nth-child(5n)::after {
                    content: "";
                    position: absolute;
                    z-index: -1;
                    width: 100%;
                    height: 5px;
                    background: linear-gradient(90deg, ${isDarkMode ? '#FFD700' : '#E40303'} 33%, ${isDarkMode ? '#E40303' : '#0087CC'} 33%, ${isDarkMode ? '#E40303' : '#0087CC'} 66%, ${isDarkMode ? '#0087CC' : '#FFD700'} 66%);
                    left: 0;
                    bottom: -7px;
                }
                
                .command-key {
                    margin-bottom: 0.5rem !important;
                    background-color: ${colors.tertiaryColor} !important;
                    color: #000000 !important;
                    padding: 2px 10px !important;
                    font-weight: bold !important;
                    transform: rotate(-3deg) !important;
                }
                
                .command-name {
                    text-transform: uppercase !important;
                    font-weight: 600 !important;
                    letter-spacing: 0.05em !important;
                }
                
                .settings-dot {
                    position: fixed !important;
                    width: 15px !important;
                    height: 15px !important;
                    background-color: ${colors.primaryColor} !important;
                    border-radius: 0 !important;
                    transform: rotate(45deg) translateX(-50%) !important;
                }
                
                .settings-dot:hover {
                    transform: rotate(135deg) translateX(-50%) !important;
                    background-color: ${colors.secondaryColor} !important;
                }
                
                .corner-text {
                    text-transform: uppercase !important;
                    letter-spacing: 0.2em !important;
                    font-weight: 700 !important;
                    font-family: "Futura PT", "Bauhaus 93", sans-serif !important;
                }
            `;
            document.head.appendChild(bauhausStyle);
        } else {
            const existingBauhausStyle = document.getElementById('bauhaus-style');
            if (existingBauhausStyle) existingBauhausStyle.remove();
        }
        
        // Vaporwave theme effects
        if (themeName === 'vaporwave') {
            const vaporwaveStyle = document.createElement('style');
            vaporwaveStyle.id = 'vaporwave-style';
            vaporwaveStyle.textContent = `
                @keyframes drift {
                    from { transform: translateY(-8px) rotate(0deg); }
                    to { transform: translateY(8px) rotate(0deg); }
                }
                
                @keyframes hueRotate {
                    0% { filter: hue-rotate(0deg); }
                    100% { filter: hue-rotate(360deg); }
                }
                
                html {
                    position: relative;
                }
                
                html::before {
                    content: "";
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-image: 
                        linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.02) 50%, transparent 100%),
                        repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(0,0,0,0.03) 1px, rgba(0,0,0,0.03) 2px);
                    background-size: 100% 2px, 100% 2px;
                    pointer-events: none;
                    z-index: 1000;
                    opacity: 0.4;
                }
                
                .commands {
                    position: relative;
                    transform-style: preserve-3d;
                    perspective: 800px;
                }
                
                .command {
                    margin-bottom: 0.8rem !important;
                    transform-style: preserve-3d;
                    transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
                    position: relative;
                }
                
                .command::before {
                    content: "";
                    position: absolute;
                    top: 5px;
                    left: 5px;
                    width: 100%;
                    height: 100%;
                    background: linear-gradient(135deg, ${isDarkMode ? 'rgba(253, 122, 184, 0.4)' : 'rgba(117, 255, 225, 0.4)'}, transparent);
                    z-index: -1;
                    transform: translateZ(-10px);
                    pointer-events: none;
                }
                
                .command:hover {
                    transform: translateZ(10px) !important;
                }
                
                .command-key {
                    background: ${isDarkMode ? 'rgba(253, 122, 184, 0.3)' : 'rgba(117, 255, 225, 0.3)'} !important;
                    box-shadow: 0 0 10px 2px ${isDarkMode ? 'rgba(253, 122, 184, 0.3)' : 'rgba(117, 255, 225, 0.3)'} !important;
                    padding: 2px 8px !important;
                    transform-style: preserve-3d !important;
                    animation: drift 3s ease-in-out infinite alternate !important;
                }
                
                .command:nth-child(odd) .command-key {
                    animation-delay: 0.5s !important;
                }
                
                .command-name {
                    font-family: "VT323", "Windows Command Prompt", monospace !important;
                    font-size: 1.1em !important;
                    transform: translateZ(5px) !important;
                }
                
                .settings-dot {
                    width: 12px !important;
                    height: 12px !important;
                    background: linear-gradient(45deg, ${isDarkMode ? '#fd7ab8' : '#75ffe1'}, white) !important;
                    border-radius: 0 !important;
                    animation: hueRotate 20s linear infinite !important;
                    box-shadow: 0 0 15px ${isDarkMode ? 'rgba(253, 122, 184, 0.7)' : 'rgba(117, 255, 225, 0.7)'} !important;
                }
                
                .corner-text {
                    font-family: "VT323", monospace !important;
                    font-size: 0.9rem !important;
                    letter-spacing: 0.05em !important;
                    transform-style: preserve-3d !important;
                    animation: drift 8s ease-in-out infinite alternate !important;
                }
            `;
            document.head.appendChild(vaporwaveStyle);
        } else {
            const existingVaporwaveStyle = document.getElementById('vaporwave-style');
            if (existingVaporwaveStyle) existingVaporwaveStyle.remove();
        }
        
        // Nordic theme effects
        if (themeName === 'nordic') {
            const nordicStyle = document.createElement('style');
            nordicStyle.id = 'nordic-style';
            nordicStyle.textContent = `
                .commands {
                    display: grid !important;
                    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)) !important;
                    grid-gap: 2.2rem !important;
                    grid-auto-flow: row !important;
                    padding: 1.5rem !important;
                    max-width: 50rem !important;
                    background-color: ${isDarkMode ? 'rgba(33, 37, 41, 0.7)' : 'rgba(248, 249, 250, 0.7)'} !important;
                    backdrop-filter: blur(20px) !important;
                    border-radius: 8px !important;
                    border: 1px solid ${isDarkMode ? 'rgba(52, 58, 64, 0.8)' : 'rgba(222, 226, 230, 0.8)'} !important;
                }
                
                .command {
                    display: flex !important;
                    flex-direction: column !important;
                    align-items: center !important;
                    text-align: center !important;
                    padding: 1rem !important;
                    border-radius: 6px !important;
                    transition: all 0.3s ease !important;
                    background-color: ${isDarkMode ? 'rgba(33, 37, 41, 0.7)' : 'rgba(248, 249, 250, 0.7)'} !important;
                    box-shadow: 0 2px 5px ${isDarkMode ? 'rgba(0, 0, 0, 0.15)' : 'rgba(0, 0, 0, 0.05)'} !important;
                    border: 1px solid ${isDarkMode ? 'rgba(52, 58, 64, 0.8)' : 'rgba(222, 226, 230, 0.8)'} !important;
                }
                
                .command:hover {
                    transform: translateY(-3px) !important;
                    box-shadow: 0 5px 15px ${isDarkMode ? 'rgba(0, 0, 0, 0.25)' : 'rgba(0, 0, 0, 0.08)'} !important;
                }
                
                .command-key {
                    color: ${isDarkMode ? '#88c0d0' : '#5e81ac'} !important;
                    font-weight: 500 !important;
                    font-size: 0.9em !important;
                    margin-bottom: 0.75rem !important;
                    border-radius: 4px !important;
                    background-color: ${isDarkMode ? 'rgba(136, 192, 208, 0.1)' : 'rgba(94, 129, 172, 0.1)'} !important;
                    padding: 0.25rem 0.5rem !important;
                    border: 1px solid ${isDarkMode ? 'rgba(136, 192, 208, 0.2)' : 'rgba(94, 129, 172, 0.2)'} !important;
                }
                
                .command-name {
                    font-weight: 400 !important;
                    color: ${isDarkMode ? '#e9ecef' : '#212529'} !important;
                    letter-spacing: 0.02em !important;
                }
                
                .settings-dot {
                    width: 4px !important;
                    height: 4px !important;
                    background-color: ${isDarkMode ? '#88c0d0' : '#5e81ac'} !important;
                    opacity: 0.7 !important;
                    border-radius: 50% !important;
                    transition: all 0.3s ease !important;
                }
                
                .settings-dot:hover {
                    opacity: 1 !important;
                    transform: translateX(-50%) scale(1.5) !important;
                }
                
                .corner-text {
                    font-family: "Inter", system-ui, sans-serif !important;
                    font-size: 0.75rem !important;
                    font-weight: 500 !important;
                    opacity: 0.8 !important;
                }
            `;
            document.head.appendChild(nordicStyle);
        } else {
            const existingNordicStyle = document.getElementById('nordic-style');
            if (existingNordicStyle) existingNordicStyle.remove();
        }
        
        if (colors.keyHoverGlow === 'true') {
            const keyGlowStyle = document.createElement('style');
            keyGlowStyle.id = 'key-hover-glow';
            keyGlowStyle.textContent = `
                .command-key:hover {
                    box-shadow: 0 0 15px ${colors.accent};
                    text-shadow: 0 0 10px ${colors.accent};
                }
            `;
            document.head.appendChild(keyGlowStyle);
        } else {
            const existingKeyGlow = document.getElementById('key-hover-glow');
            if (existingKeyGlow) existingKeyGlow.remove();
        }
        
        if (colors.keyStyle) {
            const keyStyleEl = document.createElement('style');
            keyStyleEl.id = 'custom-key-style';
            keyStyleEl.textContent = `
                .command-key {
                    ${colors.keyStyle}
                }
            `;
            document.head.appendChild(keyStyleEl);
        } else {
            const existingKeyStyle = document.getElementById('custom-key-style');
            if (existingKeyStyle) existingKeyStyle.remove();
        }
        
        if (colors.borderStyle) {
            document.documentElement.style.setProperty('--border-style', colors.borderStyle);
            if (colors.borderWidth) {
                document.documentElement.style.setProperty('--border-width', colors.borderWidth);
            }
            if (colors.borderColor) {
                document.documentElement.style.setProperty('--border-color', colors.borderColor);
            }
        }
        
        // Handle special theme properties
        if (themeName === 'minimal') {
            // Set minimal styles for corner texts
            document.querySelectorAll('.corner-text').forEach(el => {
                el.style.opacity = '0';
            });
            
            // Style settings dot for minimal theme
            const settingsDot = document.querySelector('.settings-dot');
            if (settingsDot) {
                settingsDot.style.width = '3px';
                settingsDot.style.height = '3px';
                settingsDot.style.opacity = '0.3';
            }
            
        } else if (themeName === 'glass') {
            // Apply glass theme properties
            document.documentElement.style.backdropFilter = colors.backdropFilter || 'blur(10px)';
            
            // Style corner texts for glass theme
            document.querySelectorAll('.corner-text').forEach(el => {
                el.style.cssText = colors.cornerTextStyle || '';
                el.style.opacity = '0.8';
            });
            
            // Style the settings dot
            const settingsDot = document.querySelector('.settings-dot');
            if (settingsDot) {
                settingsDot.style.width = colors.dotSize || '6px';
                settingsDot.style.height = colors.dotSize || '6px';
                settingsDot.style.opacity = colors.dotOpacity || '0.7';
                settingsDot.style.backgroundColor = colors.accent;
                settingsDot.style.boxShadow = '0 0 10px ' + colors.accent;
            }
            
        } else if (themeName === 'ocean') {
            // Apply Ocean theme properties
            document.documentElement.style.backdropFilter = colors.backdropFilter || 'blur(8px)';
            
            // Style corner texts for Ocean theme
            document.querySelectorAll('.corner-text').forEach(el => {
                el.style.cssText = colors.cornerTextStyle || '';
                el.style.opacity = colors.cornerTextOpacity || '0.85';
            });
            
            // Style the settings dot for Ocean theme
            const settingsDot = document.querySelector('.settings-dot');
            if (settingsDot) {
                settingsDot.style.width = colors.dotSize || '8px';
                settingsDot.style.height = colors.dotSize || '8px';
                settingsDot.style.opacity = colors.dotOpacity || '0.8';
                settingsDot.style.backgroundColor = colors.accent;
                settingsDot.style.boxShadow = '0 0 12px ' + colors.accent;
            }
            
            // Add animations if enabled
            if (colors.uiAnimation === 'true') {
                // Add pulse animation to the dot
                const styleElement = document.getElementById('ocean-animations');
                if (!styleElement) {
                    const style = document.createElement('style');
                    style.id = 'ocean-animations';
                    style.textContent = `
                        @keyframes pulse {
                            0% { transform: translateX(-50%) scale(1); }
                            50% { transform: translateX(-50%) scale(1.2); }
                            100% { transform: translateX(-50%) scale(1); }
                        }
                        .settings-dot:hover {
                            animation: pulse 1.5s infinite ease-in-out;
                        }
                    `;
                    document.head.appendChild(style);
                }
            } else {
                const styleElement = document.getElementById('ocean-animations');
                if (styleElement) {
                    styleElement.remove();
                }
            }
            
        } else if (themeName === 'swiss') {
            // Apply Swiss theme properties for typography
            if (colors.letterSpacing) {
                document.documentElement.style.letterSpacing = colors.letterSpacing;
            }
            
            if (colors.fontWeight) {
                document.documentElement.style.fontWeight = colors.fontWeight;
            }
            
            // Style corner texts for Swiss theme
            document.querySelectorAll('.corner-text').forEach(el => {
                el.style.textTransform = colors.cornerTextTransform || 'uppercase';
                el.style.letterSpacing = colors.cornerTextSpacing || '0.1em';
                el.style.fontWeight = colors.cornerTextWeight || '400';
                el.style.fontSize = colors.cornerTextSize || '0.65rem';
                el.style.opacity = '0.8';
            });
            
            // Style the settings dot
            const settingsDot = document.querySelector('.settings-dot');
            if (settingsDot) {
                settingsDot.style.width = '4px';
                settingsDot.style.height = '4px';
                settingsDot.style.opacity = '0.7';
                settingsDot.style.backgroundColor = colors.accent;
                settingsDot.style.boxShadow = 'none';
            }
            
            // Add responsive styles for Swiss theme
            const styleElement = document.getElementById('swiss-style');
            if (!styleElement) {
                const swissStyle = document.createElement('style');
                swissStyle.id = 'swiss-style';
                swissStyle.textContent = `
                    @media (max-width: 768px) {
                        .corner-text {
                            padding: 1rem !important;
                            max-width: 150px !important;
                        }
                        
                        .top-left, .top-right, .bottom-left, .bottom-right {
                            font-size: 0.6rem !important;
                        }
                    }
                    
                    @media (max-width: 480px) {
                        .top-left, .bottom-right {
                            display: none !important;
                        }
                        
                        .top-right, .bottom-left {
                            padding: 0.75rem !important;
                            font-size: 0.55rem !important;
                        }
                    }
                `;
                document.head.appendChild(swissStyle);
            }
        } else if (themeName === 'mac') {
            // Apply Mac theme properties with 3D keyboard-like effects
            if (colors.fontWeight) {
                document.documentElement.style.fontWeight = colors.fontWeight;
            }
            
            // Style corner texts for Mac theme
            document.querySelectorAll('.corner-text').forEach(el => {
                el.style.cssText = colors.cornerTextStyle || '';
                el.style.opacity = '0.7';
            });
            
            // Style the settings dot
            const settingsDot = document.querySelector('.settings-dot');
            if (settingsDot) {
                settingsDot.style.width = colors.dotSize || '4px';
                settingsDot.style.height = colors.dotSize || '4px';
                settingsDot.style.opacity = colors.dotOpacity || '0.1';
                settingsDot.style.backgroundColor = colors.accent;
                settingsDot.style.boxShadow = 'none';
            }
            
            // Create the Mac 3D keyboard style for shortcuts 
            const macStyleElement = document.getElementById('mac-style');
            if (!macStyleElement) {
                const macStyle = document.createElement('style');
                macStyle.id = 'mac-style';
                macStyle.textContent = `
                    .command-key {
                        ${colors.keyStyle}
                        width: ${colors.keyWidth || '30px'};
                        height: ${colors.keyHeight || '30px'};
                        border-radius: ${colors.keyBorderRadius || '4px'};
                        padding: ${colors.keyPadding || '6px 8px'};
                        text-align: ${colors.keyTextAlign || 'center'};
                        vertical-align: ${colors.keyVerticalAlign || 'middle'};
                        font-size: ${colors.keyFontSize || '0.9em'};
                        margin-bottom: 0.75rem !important;
                        display: inline-block;
                        min-width: ${colors.keyWidth || '30px'};
                        line-height: 1.1;
                    }
                    
                    .command-key:hover {
                        ${colors.keyHoverStyle}
                    }
                    
                    .command-key:active {
                        ${colors.keyActiveStyle}
                    }
                    
                    .command-name {
                        font-weight: 500;
                        transition: color 0.2s ease;
                    }
                    
                    .command-name:hover {
                        color: ${colors.nameHoverColor} !important;
                    }
                    
                    li.command {
                        margin-bottom: 1.2rem !important;
                    }
                    
                    .commands {
                        padding: ${colors.commandPadding || '1.5rem'} !important;
                    }
                    
                    #widget-container {
                        opacity: 0.9;
                    }
                    
                    input[type="text"], input[type="url"] {
                        ${colors.inputStyle || ''}
                    }
                    
                    @media (max-width: 768px) {
                        .commands {
                            columns: 2 !important;
                        }
                    }
                `;
                document.head.appendChild(macStyle);
            }
        } else {
            // Reset to default styles for default theme
            document.documentElement.style.backdropFilter = 'none';
            document.documentElement.style.letterSpacing = '';
            document.documentElement.style.fontWeight = '';
            
            // Remove theme-specific style elements
            const oceanStyles = document.getElementById('ocean-animations');
            if (oceanStyles) oceanStyles.remove();
            
            const swissStyles = document.getElementById('swiss-style');
            if (swissStyles) swissStyles.remove();
            
            const macStyles = document.getElementById('mac-style');
            if (macStyles) macStyles.remove();
            
            // Show corner texts for default theme
            document.querySelectorAll('.corner-text').forEach(el => {
                el.style.cssText = '';
                el.style.opacity = '';
            });
            
            // Reset dot size
            const settingsDot = document.querySelector('.settings-dot');
            if (settingsDot) {
                settingsDot.style.width = '4px';
                settingsDot.style.height = '4px';
                settingsDot.style.opacity = '0.5';
                settingsDot.style.backgroundColor = '';
                settingsDot.style.boxShadow = '';
            }
        }
        
        // Dispatch theme changed event for other components
        document.dispatchEvent(new CustomEvent('themeChanged', {
            detail: { theme: themeName, darkMode: isDarkMode }
        }));
    }

    document.addEventListener('DOMContentLoaded', function() {
        function updateLinks(isLocal) {
            COMMANDS.forEach((value, key) => {
                try {
                    const url = new URL(value.url);
                    if (isLocal && url.hostname === 'ams') {
                        url.hostname = '192.168.1.9';
                    } else if (!isLocal && url.hostname === '192.168.1.9') {
                        url.hostname = 'ams';
                    }
                    value.url = url.toString();
                    console.log(`Updated command ${key}: ${value.url}`);
                } catch (e) {
                    console.error(`Error updating URL for command ${key}:`, e);
                }
            });
            
            // After updating links, manually trigger a re-render of the commands component
            setTimeout(() => {
                const commandsComponent = document.querySelector('commands-component');
                if (commandsComponent) {
                    commandsComponent.initialize();
                }
                // Make sure the page is visible
                document.body.classList.remove('loading');
            }, 10);
        }

        function isLocalNetwork() {
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    const publicIP = data.ip;
                    console.log('Detected public IP:', publicIP);

                    // Resolve a.088899.xyz to get the current public IP
                    fetch('https://dns.google/resolve?name=a.088899.xyz&type=A')
                        .then(response => response.json())
                        .then(dnsData => {
                            const domainIP = dnsData.Answer[0].data;
                            console.log('Resolved domain IP:', domainIP);

                            const isLocal = publicIP === domainIP;
                            console.log('Is local network:', isLocal);

                            updateLinks(isLocal);
                        })
                        .catch(error => {
                            console.error('Error resolving domain IP:', error);
                            // Show the body even if there's an error
                            document.body.classList.remove('loading');
                        });
                })
                .catch(error => {
                    console.error('Error detecting public IP:', error);
                    // Show the body even if there's an error
                    document.body.classList.remove('loading');
                });
        }

        // Start the local network check
        isLocalNetwork();
        
        // Create settings dot that links to settings.html
        const settingsDot = document.createElement('a');
        settingsDot.className = 'settings-dot';
        settingsDot.href = 'settings.html';
        document.body.appendChild(settingsDot);
        
        // Set greeting and quote
        document.getElementById('greeting').textContent = getGreeting();
        document.getElementById('quote').textContent = getRandomQuote();
        
        // Load corner text
        loadCornerText();
        
        // Failsafe: ensure page becomes visible after 2 seconds no matter what
        setTimeout(() => {
            document.body.classList.remove('loading');
        }, 2000);
    });

    class Commands extends HTMLElement {
        constructor() {
            super();
            this.attachShadow({ mode: 'open' });
            
            // Apply theme styling immediately in constructor before rendering
            // to prevent any flash of unstyled content
            this._preStyleShadowRoot();
            
            // Wait for the document to be fully loaded before initializing
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', () => this.initialize());
            } else {
                this.initialize();
            }
        }
        
        // Pre-style the shadow root with theme-specific styles before content is added
        _preStyleShadowRoot() {
            try {
                // Get current theme from document
                const themeName = document.documentElement.dataset.theme || 'default';
                const isDarkMode = document.documentElement.dataset.darkMode === 'true';
                
                // Create a style element for basic container styling
                const style = document.createElement('style');
                
                // Get theme-specific properties based on current theme
                let backgroundColor = 'transparent';
                let border = '1px solid rgba(0, 0, 0, 0.02)';
                let boxShadow = 'var(--box-shadow)';
                let maxWidth = '52rem';
                let backdropFilter = 'none';
                
                if (themeName === 'minimal') {
                    backgroundColor = 'transparent';
                    border = 'none';
                    boxShadow = 'none';
                    maxWidth = '70rem';
                } else if (themeName === 'glass') {
                    backgroundColor = isDarkMode ? 'rgba(30, 41, 59, 0.5)' : 'rgba(255, 255, 255, 0.6)';
                    border = isDarkMode ? '1px solid rgba(255, 255, 255, 0.1)' : '1px solid rgba(255, 255, 255, 0.2)';
                    boxShadow = isDarkMode ? '0 8px 32px rgba(0, 0, 0, 0.2)' : '0 8px 32px rgba(0, 0, 0, 0.07)';
                    backdropFilter = 'blur(10px)';
                    maxWidth = '60rem';
                } else if (themeName === 'ocean') {
                    backgroundColor = isDarkMode ? 'rgba(0, 59, 66, 0.7)' : 'rgba(224, 247, 250, 0.8)';
                    border = isDarkMode ? '1px solid rgba(38, 198, 218, 0.2)' : '1px solid rgba(129, 212, 250, 0.4)';
                    boxShadow = isDarkMode ? '0 6px 24px rgba(0, 172, 193, 0.15)' : '0 6px 24px rgba(0, 131, 143, 0.1)';
                    backdropFilter = 'blur(8px)';
                    maxWidth = '55rem';
                } else if (themeName === 'swiss') {
                    backgroundColor = 'transparent';
                    border = 'none';
                    boxShadow = 'none';
                    maxWidth = '80rem';
                } else if (themeName === 'mac') {
                    backgroundColor = isDarkMode ? 'rgba(28, 28, 30, 0.8)' : 'rgba(255, 255, 255, 0.8)';
                    border = isDarkMode ? '1px solid rgba(255, 255, 255, 0.05)' : '1px solid rgba(0, 0, 0, 0.05)';
                    boxShadow = isDarkMode ? '0 10px 20px rgba(0, 0, 0, 0.15)' : '0 10px 20px rgba(0, 0, 0, 0.05)';
                    backdropFilter = 'blur(5px)';
                    maxWidth = '70rem';
                }
                
                // Create basic CSS for the commands container
                style.textContent = `
                    .commands {
                        border-radius: var(--border-radius);
                        column-gap: 2.5rem;
                        columns: 1;
                        list-style: none;
                        margin: 0 auto;
                        overflow: hidden;
                        padding: 2rem;
                        width: 100vw;
                        background-color: ${backgroundColor};
                        border: ${border};
                        box-shadow: ${boxShadow};
                        max-width: ${maxWidth};
                        backdrop-filter: ${backdropFilter};
                    }
                    
                    @media (min-width: 500px) {
                        .commands {
                            columns: 2;
                            max-width: ${themeName === 'minimal' ? '30rem' : '30rem'};
                        }
                    }

                    @media (min-width: 900px) {
                        .commands {
                            columns: ${themeName === 'ocean' ? '3' : '4'};
                            max-width: ${maxWidth};
                        }
                    }
                `;
                
                // Add the style to shadow root
                this.shadowRoot.appendChild(style);
            } catch (e) {
                console.error('Error pre-styling commands component:', e);
            }
        }
        
        initialize() {
            const template = document.getElementById('commands-template');
            const clone = template.content.cloneNode(true);
            const commands = clone.querySelector('.commands');
            const commandTemplate = document.getElementById('command-template');
            
            commands.innerHTML = ''; // Clear existing commands
            
            // Use an array to keep the original order consistent
            const commandEntries = Array.from(COMMANDS.entries());
            
            // Store the original order of keys for reference
            if (!window.originalCommandOrder) {
                window.originalCommandOrder = commandEntries.map(([key]) => key);
            }
            
            // Get current theme
            const currentTheme = document.documentElement.dataset.theme || 'default';
            const isDarkMode = document.documentElement.dataset.darkMode === 'true';
            
            // If Swiss theme or Mac theme is active, ensure we preserve the original order
            if ((currentTheme === 'swiss' || currentTheme === 'mac') && window.originalCommandOrder) {
                // Sort command entries using the original order
                commandEntries.sort((a, b) => {
                    const indexA = window.originalCommandOrder.indexOf(a[0]);
                    const indexB = window.originalCommandOrder.indexOf(b[0]);
                    return indexA - indexB;
                });
            }
            
            for (const [key, { name, url }] of commandEntries) {
                if (!name || !url) continue;
                const clone = commandTemplate.content.cloneNode(true);
                const command = clone.querySelector('.command');
                
                // Set command properties
                command.href = url;
                command.dataset.key = key; // Store the key as a data attribute
                command.setAttribute('data-key', key); // Set as attribute for older browsers
                
                // Set target for external links
                if (CONFIG.openLinksInNewTab) command.target = '_blank';
                
                // Set text content for key and name
                clone.querySelector('.key').textContent = key;
                clone.querySelector('.name').textContent = name;
                
                // Add to commands list
                commands.append(clone);
            }
            
            // Clear any pre-styles we added before appending the template content
            this.shadowRoot.innerHTML = '';
            this.shadowRoot.append(clone);
            
            // Apply theme-specific styling to commands
            this.applyThemeStyling(currentTheme, isDarkMode);
        }
        
        // Method to apply theme-specific styling to commands
        applyThemeStyling(themeName, isDarkMode) {
            // Get the commands container
            const commandsMenu = this.shadowRoot.querySelector('.commands');
            if (!commandsMenu) return;
            
            // Reset any previously applied styles
            commandsMenu.style.backgroundColor = '';
            commandsMenu.style.border = '';
            commandsMenu.style.boxShadow = '';
            commandsMenu.style.backdropFilter = '';
            commandsMenu.style.maxWidth = '';
            commandsMenu.style.paddingTop = '';
            
            // Get all keys and names for styling
            const keys = this.shadowRoot.querySelectorAll('.key');
            keys.forEach(key => {
                key.style.color = '';
                key.style.opacity = '';
                key.style.fontWeight = '';
                key.style.fontSize = '';
                key.style.width = '';
                key.style.textAlign = '';
            });
            
            const names = this.shadowRoot.querySelectorAll('.name');
            names.forEach(name => {
                name.style.letterSpacing = '';
                name.style.textTransform = '';
                name.style.fontSize = '';
                name.style.opacity = '';
            });
            
            // Remove any theme-specific styles
            const themeStyles = this.shadowRoot.querySelectorAll('.theme-style');
            themeStyles.forEach(style => style.remove());
            
            // Apply theme-specific styles based on current theme
            if (themeName === 'minimal') {
                // Apply minimal theme to commands
                commandsMenu.style.backgroundColor = 'transparent';
                commandsMenu.style.border = 'none';
                commandsMenu.style.boxShadow = 'none';
                commandsMenu.style.maxWidth = '70rem';
                
                // Update key colors with minimal theme styling
                keys.forEach(key => {
                    key.style.color = isDarkMode ? '#999999' : '#666666';
                });
                
            } else if (themeName === 'glass') {
                // Apply glass theme to commands
                commandsMenu.style.backgroundColor = isDarkMode ? 'rgba(30, 41, 59, 0.5)' : 'rgba(255, 255, 255, 0.6)';
                commandsMenu.style.border = isDarkMode ? '1px solid rgba(255, 255, 255, 0.1)' : '1px solid rgba(255, 255, 255, 0.2)';
                commandsMenu.style.boxShadow = isDarkMode ? '0 8px 32px rgba(0, 0, 0, 0.2)' : '0 8px 32px rgba(0, 0, 0, 0.07)';
                commandsMenu.style.backdropFilter = 'blur(10px)';
                commandsMenu.style.maxWidth = '60rem';
                
                // Update key colors and make them more prominent
                keys.forEach(key => {
                    key.style.color = isDarkMode ? '#38bdf8' : '#3b82f6';
                    key.style.opacity = '1';
                    key.style.fontWeight = '600';
                });
                
                // Update name underline style
                names.forEach(name => {
                    name.style.letterSpacing = '0.02em';
                });
                
                // Add style for name underline
                const style = document.createElement('style');
                style.className = 'theme-style';
                style.textContent = `.name::after { height: 2px !important; }`;
                this.shadowRoot.appendChild(style);
                
            } else if (themeName === 'ocean') {
                // Apply Ocean theme to commands
                commandsMenu.style.backgroundColor = isDarkMode ? 'rgba(0, 59, 66, 0.7)' : 'rgba(224, 247, 250, 0.8)';
                commandsMenu.style.border = isDarkMode ? '1px solid rgba(38, 198, 218, 0.2)' : '1px solid rgba(129, 212, 250, 0.4)';
                commandsMenu.style.boxShadow = isDarkMode ? '0 6px 24px rgba(0, 172, 193, 0.15)' : '0 6px 24px rgba(0, 131, 143, 0.1)';
                commandsMenu.style.backdropFilter = 'blur(8px)';
                commandsMenu.style.maxWidth = '55rem';
                
                // Update key colors with Ocean theme styling
                keys.forEach(key => {
                    key.style.color = isDarkMode ? '#26c6da' : '#00acc1';
                    key.style.opacity = '1';
                    key.style.fontWeight = '600';
                });
                
                // Update name styles with Ocean theme styling
                names.forEach(name => {
                    name.style.letterSpacing = '0.03em';
                    name.style.fontWeight = '500';
                });
                
                // Set columns for the commands menu
                const style = document.createElement('style');
                style.className = 'theme-style';
                style.textContent = `
                    @media (min-width: 500px) {
                        .commands {
                            columns: 3 !important;
                        }
                    }
                    
                    .name::after { 
                        height: 2px !important; 
                        background-color: ${isDarkMode ? '#26c6da' : '#00838f'} !important;
                    }
                    
                    .command {
                        transition: transform 0.3s ease, box-shadow 0.3s ease !important;
                    }
                    .command:hover {
                        transform: translateY(-2px) !important;
                        box-shadow: 0 4px 12px ${isDarkMode ? 'rgba(0, 172, 193, 0.15)' : 'rgba(0, 131, 143, 0.15)'} !important;
                    }
                `;
                this.shadowRoot.appendChild(style);
                
            } else if (themeName === 'swiss') {
                // Apply Swiss theme properties - minimal, typography focused, red accent
                commandsMenu.style.backgroundColor = 'transparent';
                commandsMenu.style.border = 'none';
                commandsMenu.style.boxShadow = 'none';
                commandsMenu.style.maxWidth = '80rem';
                commandsMenu.style.paddingTop = '3rem';
                
                // Update key styling with Swiss typography principles
                keys.forEach(key => {
                    key.style.color = '#ff3b30';
                    key.style.opacity = '1';
                    key.style.fontWeight = '700';
                    key.style.fontSize = '1.1em';
                    key.style.width = 'auto';
                    key.style.textAlign = 'left';
                });
                
                // Update name styles with Swiss typography
                names.forEach(name => {
                    name.style.letterSpacing = '0.05em';
                    name.style.textTransform = 'uppercase';
                    name.style.fontSize = '0.8em';
                    name.style.opacity = '0.9';
                });
                
                // Add grid layout for Swiss theme
                const style = document.createElement('style');
                style.className = 'theme-style';
                style.textContent = `
                    .commands {
                        display: grid !important;
                        grid-template-columns: repeat(4, 1fr) !important;
                        grid-template-rows: repeat(3, auto) !important;
                        grid-gap: 1.5rem !important;
                        grid-auto-flow: column !important;
                        columns: unset !important;
                        padding: 1.5rem !important;
                        justify-content: center !important;
                        align-items: start !important;
                        width: auto !important;
                        max-width: 52rem !important;
                        margin: 0 auto !important;
                    }
                    
                    .command {
                        display: flex !important;
                        flex-direction: column !important;
                        align-items: flex-start !important;
                        gap: 0.5rem !important;
                        border-left: 2px solid transparent !important;
                        padding-left: 0.5rem !important;
                        transition: all 0.2s ease !important;
                        margin-bottom: 0.5rem !important;
                    }
                    
                    .command:hover {
                        border-left-color: #ff3b30 !important;
                    }
                    
                    .command:hover .name {
                        color: #ff3b30 !important;
                    }
                    
                    .name::after {
                        display: none !important;
                    }
                    
                    @media (max-width: 768px) {
                        .commands {
                            grid-template-columns: repeat(4, minmax(90px, 1fr)) !important;
                            grid-gap: 1rem !important;
                            padding: 1rem !important;
                            max-width: 42rem !important;
                        }
                        
                        .command {
                            margin-bottom: 0.25rem !important;
                        }
                        
                        .key {
                            font-size: 1em !important;
                        }
                        
                        .name {
                            font-size: 0.75em !important;
                        }
                    }
                    
                    @media (max-width: 480px) {
                        .commands {
                            grid-template-columns: repeat(2, minmax(90px, 1fr)) !important;
                            max-width: 22rem !important;
                            padding: 0.8rem !important;
                        }
                        
                        .key {
                            font-size: 0.9em !important;
                        }
                        
                        .name {
                            font-size: 0.7em !important;
                            letter-spacing: 0.03em !important;
                        }
                    }
                `;
                this.shadowRoot.appendChild(style);
                
            } else if (themeName === 'mac') {
                // Apply Mac theme with 3D keyboard effect
                commandsMenu.style.backgroundColor = 'transparent';
                commandsMenu.style.border = 'none';
                commandsMenu.style.boxShadow = 'none';
                commandsMenu.style.backdropFilter = 'none';
                commandsMenu.style.maxWidth = '70rem';
                
                // Update keys with 3D keyboard styling
                const macStyle = document.createElement('style');
                macStyle.className = 'theme-style';
                macStyle.textContent = `
                    .key {
                        display: flex !important;
                        align-items: center !important;
                        justify-content: center !important;
                        width: 60px !important;
                        height: 60px !important;
                        border-radius: 7px !important;
                        padding: 0 !important;
                        text-align: center !important;
                        vertical-align: middle !important;
                        font-size: 1.2em !important;
                        margin-bottom: 0 !important;
                        line-height: 1 !important;
                        opacity: 1 !important;
                        font-weight: 500 !important;
                        text-shadow: none !important;
                        transform: translateY(0) !important;
                        transition: all 0.1s ease !important;
                        position: relative !important;
                        ${isDarkMode ? 
                          'background: linear-gradient(to bottom, #3a3a3c, #2c2c2e) !important; border: 1px solid #1c1c1e !important; box-shadow: 0 1px 2px rgba(0,0,0,0.2), 0 -1px 0 rgba(255,255,255,0.1) inset, 0 1px 0 rgba(0,0,0,0.2) !important; color: #f5f5f7 !important;' : 
                          'background: linear-gradient(to bottom, #f7f7f7, #e2e2e2) !important; border: 1px solid #d1d1d1 !important; box-shadow: 0 1px 2px rgba(0,0,0,0.05), 0 -1px 0 rgba(255,255,255,0.5) inset, 0 1px 0 rgba(0,0,0,0.1) !important; color: #1d1d1f !important;'}
                    }
                    
                    .key:hover {
                        transform: translateY(-1px) !important;
                        ${isDarkMode ? 
                          'box-shadow: 0 2px 3px rgba(0,0,0,0.3), 0 -1px 0 rgba(255,255,255,0.1) inset, 0 1px 0 rgba(0,0,0,0.2) !important;' : 
                          'box-shadow: 0 2px 3px rgba(0,0,0,0.07), 0 -1px 0 rgba(255,255,255,0.5) inset, 0 1px 0 rgba(0,0,0,0.1) !important;'}
                    }
                    
                    .key:active {
                        transform: translateY(1px) !important;
                        ${isDarkMode ? 
                          'box-shadow: 0 0 1px rgba(0,0,0,0.3), 0 -1px 0 rgba(255,255,255,0.1) inset, 0 1px 0 rgba(0,0,0,0.2) !important;' : 
                          'box-shadow: 0 0 1px rgba(0,0,0,0.1), 0 -1px 0 rgba(255,255,255,0.5) inset, 0 1px 0 rgba(0,0,0,0.1) !important;'}
                    }
                    
                    .name {
                        display: none !important;
                    }
                    
                    .command {
                        display: flex !important;
                        flex-direction: column !important;
                        align-items: center !important;
                        justify-content: center !important;
                        margin: 0 !important;
                        padding: 0 !important;
                        height: auto !important;
                    }
                    
                    .commands {
                        display: grid !important;
                        grid-template-columns: repeat(4, 60px) !important;
                        grid-template-rows: repeat(3, 65px) !important;
                        grid-column-gap: 0.8rem !important;
                        grid-row-gap: 0.6rem !important;
                        grid-auto-flow: column !important;
                        padding: 0 !important;
                        justify-content: center !important;
                        align-items: center !important;
                        margin: 0 auto !important;
                        max-width: 400px !important;
                    }
                    
                    @media (max-width: 768px) {
                        .commands {
                            grid-template-columns: repeat(4, 60px) !important;
                            grid-column-gap: 0.8rem !important;
                            grid-row-gap: 0.6rem !important;
                        }
                    }
                    
                    @media (max-width: 480px) {
                        .commands {
                            grid-template-columns: repeat(2, 60px) !important;
                            grid-column-gap: 0.8rem !important;
                            grid-row-gap: 0.6rem !important;
                        }
                    }
                `;
                this.shadowRoot.appendChild(macStyle);
                
            } else {
                // Default theme styling
                //commandsMenu.style.backgroundColor = 'rgba(255, 255, 255, 0.7)';
                commandsMenu.style.border = '1px solid rgba(0, 0, 0, 0.02)';
                commandsMenu.style.boxShadow = 'var(--box-shadow)';
            }
        }
    }

    customElements.define('commands-component', Commands);
</script>

<style>
    :root {
        --border-radius: 8px;
        --color-background: #000000; /* Black background */
        --color-text-subtle: #666666; /* Subtle gray text */
        --color-text: #f5f5f7; /* Light text for dark background */
        --color-accent: #333333; /* Accent color */
        --color-hover: #444444; /* Hover color */
        --font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        --font-size: clamp(13px, 1vw, 15px); /* Smaller font size */
        --font-weight-bold: 500;
        --font-weight-normal: 400;
        --space: .5rem;
        --transition-speed: 200ms;
        --box-shadow: 0 1px 4px rgba(0, 0, 0, 0.03);
    }
    
    /* Theme-adaptive backgrounds */

    
    /* Hide scrollbar for all browsers */
    /* For Chrome, Safari, and newer Edge */
    ::-webkit-scrollbar {
        display: none;
    }
    
    /* For Firefox */
    * {
        scrollbar-width: none;
    }
    
    /* For older IE/Edge */
    * {
        -ms-overflow-style: none;
    }
    
    /* Ensure scrolling still works */
    html, body, .app-container {
        scrollbar-width: none;
        -ms-overflow-style: none;
    }
</style>

<script>
    const CONFIG = {
        commandPathDelimiter: '/',
        commandSearchDelimiter: ' ',
        defaultSearchTemplate: 'https://www.google.com/search?q={}',
        openLinksInNewTab: false,
        suggestionLimit: 4,
    };

    const COMMANDS = new Map([
        ['a', { name: 'Plex', url: 'https://app.plex.tv/desktop/' }],
        ['b', { name: 'Sonarr', url: 'https://sonarr.088899.xyz' }],
        ['c', { name: 'Radarr', url: 'https://radarr.088899.xyz' }],
        ['i', { name: 'Transmission', url: 'https://tr.088899.xyz' }],
        ['f', { name: 'Metube', url: 'https://mt.088899.xyz' }],
        ['g', { name: 'Jackett', url: 'https://jkt.088899.xyz' }],
        ['h', { name: 'DNS', url: 'http://ams:8000' }],
        ['d', { name: 'Twitch', url: 'https://twitch.tv' }],
        ['j', { name: 'Twitter', url: 'https://x.com' }],
        ['k', { name: 'Gmail', url: 'https://gmail.com/' }],
        [
            's',
            {
                name: 'YouTube',
                searchTemplate: '/results?search_query={}',
                url: 'https://youtube.com/',
            },
        ],
        [
            'q',
            {
                name: 'Most used',
                searchTemplate: ':{}',
                suggestions: ['web.whatsapp.com', 'anilist.co', 'discord.com/app'],
                url: 'http://localhost:3000',
            },
        ],
    ]);
</script>

<template id="commands-template">
    <style>
        .commands {
            border-radius: var(--border-radius);
            column-gap: 2.5rem;
            columns: 1;
            list-style: none;
            margin: 0 auto;
            max-width: 10rem;
            overflow: hidden;
            padding: 2rem;
            width: 100vw;
            /*background-color: rgba(255, 255, 255, 0.7);*/
            border: 1px solid rgba(0, 0, 0, 0.02);
            box-shadow: var(--box-shadow);
        }

        .command {
            display: flex;
            gap: 0.8rem;
            outline: 0;
            padding: 0.4rem 0.2rem;
            position: relative;
            text-decoration: none;
            border-radius: var(--border-radius);
            margin-bottom: 12px;
            transition: all var(--transition-speed);
        }

        .command:where(:focus, :hover) {
            background-color: transparent;
        }

        .command:where(:focus, :hover) .name::after {
            width: 100%;
        }
        
        /* Style for editable commands when settings panel is open */
        .editable .command {
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease-in-out;
        }
        
        .editable .command::after {
            content: "";
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.7em;
            opacity: 0;
            transition: opacity var(--transition-speed), transform 0.2s ease;
            color: var(--color-accent);
        }
        
        .editable .command:hover::after {
            opacity: 0.8;
            transform: translateY(-50%) scale(1.2);
        }

        .editable .command:hover {
            background-color: rgba(0, 0, 0, 0.03);
            transform: translateX(3px);
            padding-right: 20px; /* Make room for the edit icon */
        }
        
        .key {
            color: var(--color-accent);
            display: inline-block;
            text-align: center;
            width: 1.5ch;
            font-weight: var(--font-weight-bold);
            font-size: 0.85em;
            opacity: 0.65;
        }
        
        .editable .key {
            color: var(--color-hover);
            font-weight: 600;
        }

        .name {
            color: var(--color-text-subtle);
            transition: color var(--transition-speed);
            letter-spacing: 0.01em;
            position: relative;
            font-size: 0.95em;
        }

        .name::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 1px;
            background-color: var(--color-text);
            transition: width var(--transition-speed);
        }

        .command:where(:focus, :hover) .name {
            color: var(--color-text);
        }

        @media (min-width: 500px) {
            .commands {
                columns: 2;
                max-width: 30rem;
            }
        }

        @media (min-width: 900px) {
            .commands {
                columns: 4;
                max-width: 52rem;
            }
        }
    </style>
    <nav>
        <menu class="commands"></menu>
    </nav>
</template>

<template id="command-template">
    <li>
        <a class="command" rel="noopener noreferrer">
            <span class="key"></span>
            <span class="name"></span>
        </a>
    </li>
</template>

<template id="search-template">
    <style>
        input,
        button {
            -moz-appearance: none;
            -webkit-appearance: none;
            background: transparent;
            border: 0;
            display: block;
            outline: 0;
        }

        .dialog {
            align-items: center;
            background: var(--color-background);
            border: none;
            display: none;
            flex-direction: column;
            height: 100%;
            justify-content: center;
            left: 0;
            padding: 0;
            top: 0;
            width: 100%;
            backdrop-filter: blur(3px);
        }

        .dialog[open] {
            display: flex;
        }

        .form {
            width: 100%;
            max-width: 500px;
        }

        .input {
            color: var(--color-text);
            font-size: 1.3rem;
            font-weight: var(--font-weight-normal);
            padding: 0.5rem 1rem;
            text-align: center;
            width: 100%;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            font-family: var(--font-family);
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: var(--border-radius);
        }

        .suggestions {
            align-items: center;
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
            justify-content: center;
            list-style: none;
            margin: var(--space) 0 0;
            overflow: hidden;
            padding: 0;
        }

        .suggestion {
            color: var(--color-text);
            cursor: pointer;
            font-size: 0.9rem;
            padding: var(--space);
            position: relative;
            transition: color var(--transition-speed);
            white-space: nowrap;
            z-index: 1;
            border-radius: var(--border-radius);
        }

        .suggestion:where(:focus, :hover) {
            color: var(--color-background);
        }

        .suggestion::before {
            background-color: var(--color-accent);
            border-radius: var(--border-radius);
            content: ' ';
            inset: calc(var(--space) / 1.5) calc(var(--space) / 3);
            opacity: 0;
            position: absolute;
            transform: translateY(0.5em);
            transition: all var(--transition-speed);
            z-index: -1;
        }

        .suggestion:where(:focus, :hover)::before {
            opacity: 1;
            transform: translateY(0);
        }

        .match {
            color: var(--color-text-subtle);
            transition: color var(--transition-speed);
        }

        .suggestion:where(:focus, :hover) .match {
            color: var(--color-background);
        }

        @media (min-width: 700px) {
            .suggestions {
                flex-direction: row;
            }
        }
    </style>
    <dialog class="dialog">
        <form autocomplete="off" class="form" method="dialog" spellcheck="false">
            <input class="input" title="search" type="text" />
            <menu class="suggestions"></menu>
        </form>
    </dialog>
</template>

<template id="suggestion-template">
    <li>
        <button class="suggestion" type="button"></button>
    </li>
</template>

<template id="match-template">
    <span class="match"></span>
</template>

<script type="module">
    class Search extends HTMLElement {
        #dialog;
        #form;
        #input;
        #suggestions;

        constructor() {
            super();
            this.attachShadow({ mode: 'open' });
            
            // Apply initial theme styling before content is loaded to prevent flashing
            this._preStyleShadowRoot();
            
            const template = document.getElementById('search-template');
            const clone = template.content.cloneNode(true);
            this.#dialog = clone.querySelector('.dialog');
            this.#form = clone.querySelector('.form');
            this.#input = clone.querySelector('.input');
            this.#suggestions = clone.querySelector('.suggestions');
            this.#form.addEventListener('submit', this.#onSubmit, false);
            this.#input.addEventListener('input', this.#onInput);
            this.#suggestions.addEventListener('click', this.#onSuggestionClick);
            document.addEventListener('keydown', this.#onKeydown);
            
            // Apply theme styling to the clone before appending
            this._applyThemeToClone(clone);
            
            this.shadowRoot.append(clone);
            
            // Listen for theme changes
            document.addEventListener('themeChanged', () => {
                this.applyThemeStyling();
            });
        }
        
        // Pre-style the shadow root with theme-specific styles before content is added
        _preStyleShadowRoot() {
            try {
                // Get current theme from document
                const themeName = document.documentElement.dataset.theme || 'default';
                const isDarkMode = document.documentElement.dataset.darkMode === 'true';
                
                // Create a style element for basic styling
                const style = document.createElement('style');
                
                // Set basic styles based on theme
                let dialogBackground = isDarkMode ? '#1a1a1a' : '#f8f5e6';
                let inputBackground = isDarkMode ? 'rgba(30, 30, 30, 0.5)' : 'rgba(255, 255, 255, 0.7)';
                let inputBorder = isDarkMode ? '1px solid rgba(255, 255, 255, 0.1)' : '1px solid rgba(0, 0, 0, 0.08)';
                let inputBorderRadius = '8px';
                let backdropFilter = 'none';
                
                // Adjust based on theme
                if (themeName === 'minimal') {
                    inputBackground = 'transparent';
                    inputBorder = isDarkMode ? '1px solid rgba(255, 255, 255, 0.2)' : '1px solid rgba(0, 0, 0, 0.2)';
                    inputBorderRadius = '0';
                } else if (themeName === 'glass') {
                    dialogBackground = 'transparent';
                    backdropFilter = 'blur(10px)';
                    inputBackground = isDarkMode ? 'rgba(30, 41, 59, 0.5)' : 'rgba(255, 255, 255, 0.6)';
                    inputBorder = isDarkMode ? '1px solid rgba(255, 255, 255, 0.1)' : '1px solid rgba(255, 255, 255, 0.2)';
                    inputBorderRadius = '16px';
                } else if (themeName === 'ocean') {
                    dialogBackground = 'transparent';
                    backdropFilter = 'blur(8px)';
                    inputBackground = isDarkMode ? 'rgba(0, 59, 66, 0.8)' : 'rgba(224, 247, 250, 0.9)';
                    inputBorder = isDarkMode ? '1px solid rgba(38, 198, 218, 0.3)' : '1px solid rgba(129, 212, 250, 0.5)';
                    inputBorderRadius = '12px';
                } else if (themeName === 'swiss') {
                    inputBackground = 'transparent';
                    inputBorder = 'none';
                    inputBorderRadius = '0';
                    inputBorder = isDarkMode ? '1px solid #ff3b30' : '1px solid #ff3b30';
                }
                
                // Create basic CSS for the search elements
                style.textContent = `
                    .dialog {
                        background-color: ${dialogBackground};
                        backdrop-filter: ${backdropFilter};
                    }
                    
                    .input {
                        background-color: ${inputBackground};
                        border: none;
                        border-bottom: ${inputBorder};
                        border-radius: ${inputBorderRadius};
                    }
                `;
                
                // Add the style to shadow root
                this.shadowRoot.appendChild(style);
            } catch (e) {
                console.error('Error pre-styling search component:', e);
            }
        }
        
        // Apply theme styling to the cloned template before appending
        _applyThemeToClone(clone) {
            try {
                const themeName = document.documentElement.dataset.theme || 'default';
                const isDarkMode = document.documentElement.dataset.darkMode === 'true';
                
                const dialog = clone.querySelector('.dialog');
                const input = clone.querySelector('.input');
                
                // Apply theme-specific styling from existing applyThemeStyling method
                if (themeName === 'minimal') {
                    input.style.backgroundColor = 'transparent';
                    input.style.border = 'none';
                    input.style.borderBottom = '1px solid ' + (isDarkMode ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.2)');
                    input.style.borderRadius = '0';
                    input.style.boxShadow = 'none';
                    input.style.fontFamily = '"Courier New", monospace';
                } else if (themeName === 'glass') {
                    dialog.style.backdropFilter = 'blur(10px)';
                    input.style.backdropFilter = 'blur(5px)';
                    input.style.backgroundColor = isDarkMode ? 'rgba(30, 41, 59, 0.5)' : 'rgba(255, 255, 255, 0.6)';
                    input.style.border = isDarkMode ? '1px solid rgba(255, 255, 255, 0.1)' : '1px solid rgba(255, 255, 255, 0.2)';
                    input.style.boxShadow = isDarkMode ? '0 8px 32px rgba(0, 0, 0, 0.2)' : '0 8px 32px rgba(0, 0, 0, 0.07)';
                    input.style.borderRadius = '16px';
                } else if (themeName === 'ocean') {
                    dialog.style.backdropFilter = 'blur(8px)';
                    input.style.backgroundColor = isDarkMode ? 'rgba(0, 59, 66, 0.8)' : 'rgba(224, 247, 250, 0.9)';
                    input.style.border = isDarkMode ? '1px solid rgba(38, 198, 218, 0.3)' : '1px solid rgba(129, 212, 250, 0.5)';
                    input.style.boxShadow = isDarkMode ? '0 2px 10px rgba(0, 172, 193, 0.15)' : '0 2px 10px rgba(0, 131, 143, 0.1)';
                    input.style.borderRadius = '12px';
                } else if (themeName === 'swiss') {
                    dialog.style.backdropFilter = 'none';
                    input.style.backgroundColor = 'transparent';
                    input.style.border = 'none';
                    input.style.borderBottom = '1px solid #ff3b30';
                    input.style.borderRadius = '0';
                    input.style.boxShadow = 'none';
                    input.style.fontFamily = '"Helvetica Neue", Arial, sans-serif';
                    input.style.letterSpacing = '0.03em';
                }
            } catch (e) {
                console.error('Error applying theme styling to clone:', e);
            }
        }
        
        // Method to apply theme styling when themes change
        applyThemeStyling() {
            const themeName = document.documentElement.dataset.theme || 'default';
            const isDarkMode = document.documentElement.dataset.darkMode === 'true';
            
            // Remove any theme-specific styles
            const themeStyles = this.shadowRoot.querySelectorAll('.theme-style');
            themeStyles.forEach(style => style.remove());
            
            // Reset styles
            this.#dialog.style.backdropFilter = '';
            this.#input.style.backdropFilter = '';
            this.#input.style.backgroundColor = '';
            this.#input.style.border = '';
            this.#input.style.boxShadow = '';
            this.#input.style.borderRadius = '';
            
            // Apply theme-specific styles based on current theme
            if (themeName === 'minimal') {
                // Minimal theme style
                this.#input.style.backgroundColor = 'transparent';
                this.#input.style.border = 'none';
                this.#input.style.borderBottom = '1px solid ' + (isDarkMode ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.2)');
                this.#input.style.borderRadius = '0';
                this.#input.style.boxShadow = 'none';
                this.#input.style.fontFamily = '"Courier New", monospace';
                
                // Add minimal style for suggestions
                const style = document.createElement('style');
                style.className = 'theme-style';
                style.textContent = `
                    .suggestion::before {
                        border-radius: 0 !important;
                        background-color: ${isDarkMode ? '#333333' : '#cccccc'} !important;
                    }
                `;
                this.shadowRoot.appendChild(style);
                
            } else if (themeName === 'glass') {
                // Glass theme style
                this.#dialog.style.backdropFilter = 'blur(10px)';
                this.#input.style.backdropFilter = 'blur(5px)';
                this.#input.style.backgroundColor = isDarkMode ? 'rgba(30, 41, 59, 0.5)' : 'rgba(255, 255, 255, 0.6)';
                this.#input.style.border = isDarkMode ? '1px solid rgba(255, 255, 255, 0.1)' : '1px solid rgba(255, 255, 255, 0.2)';
                this.#input.style.boxShadow = isDarkMode ? '0 8px 32px rgba(0, 0, 0, 0.2)' : '0 8px 32px rgba(0, 0, 0, 0.07)';
                this.#input.style.borderRadius = '16px';
                
                // Add glass style for suggestions
                const style = document.createElement('style');
                style.className = 'theme-style';
                style.textContent = `
                    .suggestion::before {
                        background-color: ${isDarkMode ? '#38bdf8' : '#3b82f6'} !important;
                        border-radius: 8px !important;
                    }
                `;
                this.shadowRoot.appendChild(style);
                
            } else if (themeName === 'ocean') {
                // Ocean theme style
                this.#dialog.style.backdropFilter = 'blur(8px)';
                this.#input.style.backgroundColor = isDarkMode ? 'rgba(0, 59, 66, 0.8)' : 'rgba(224, 247, 250, 0.9)';
                this.#input.style.border = isDarkMode ? '1px solid rgba(38, 198, 218, 0.3)' : '1px solid rgba(129, 212, 250, 0.5)';
                this.#input.style.boxShadow = isDarkMode ? '0 2px 10px rgba(0, 172, 193, 0.15)' : '0 2px 10px rgba(0, 131, 143, 0.1)';
                this.#input.style.borderRadius = '12px';
                
                // Add ocean style for suggestions
                const style = document.createElement('style');
                style.className = 'theme-style';
                style.textContent = `
                    .suggestion::before {
                        background-color: ${isDarkMode ? '#26c6da' : '#00838f'} !important;
                        border-radius: 6px !important;
                    }
                    .suggestion {
                        transition: transform 0.3s ease !important;
                    }
                    .suggestion:hover {
                        transform: translateY(-2px) !important;
                    }
                `;
                this.shadowRoot.appendChild(style);
                
            } else if (themeName === 'swiss') {
                // Swiss theme style
                this.#dialog.style.backdropFilter = 'none';
                this.#input.style.backgroundColor = 'transparent';
                this.#input.style.border = 'none';
                this.#input.style.borderBottom = '1px solid #ff3b30';
                this.#input.style.borderRadius = '0';
                this.#input.style.boxShadow = 'none';
                this.#input.style.fontFamily = '"Helvetica Neue", Arial, sans-serif';
                this.#input.style.letterSpacing = '0.03em';
                
                // Add Swiss style for the search
                const style = document.createElement('style');
                style.className = 'theme-style';
                style.textContent = `
                    .input {
                        width: 90% !important;
                        max-width: 400px !important;
                        margin: 0 auto !important;
                    }
                    
                    .suggestion::before {
                        background-color: #ff3b30 !important;
                        border-radius: 0 !important;
                    }
                    
                    @media (max-width: 480px) {
                        .input {
                            font-size: 1rem !important;
                            padding: 0.4rem 0.8rem !important;
                        }
                        
                        .suggestion {
                            font-size: 0.8rem !important;
                            padding: 0.4rem !important;
                        }
                    }
                `;
                this.shadowRoot.appendChild(style);
            }
        }

        static #attachSearchPrefix(array, { key, splitBy }) {
            if (!splitBy) return array;
            return array.map((search) => `${key}${splitBy}${search}`);
        }

        static #escapeRegexCharacters(s) {
            return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
        }

        static #fetchDuckDuckGoSuggestions(search) {
            return new Promise((resolve) => {
                window.autocompleteCallback = (res) => {
                    const suggestions = [];

                    for (const item of res) {
                        if (item.phrase === search.toLowerCase()) continue;
                        suggestions.push(item.phrase);
                    }

                    resolve(suggestions);
                };

                const script = document.createElement('script');
                document.querySelector('head').appendChild(script);
                script.src = `https://duckduckgo.com/ac/?callback=autocompleteCallback&q=${search}`;
                script.onload = script.remove;
            });
        }

        static #formatSearchUrl(url, searchPath, search) {
            if (!searchPath) return url;
            const [baseUrl] = Search.#splitUrl(url);
            const urlQuery = encodeURIComponent(search);
            searchPath = searchPath.replace(/{}/g, urlQuery);
            return baseUrl + searchPath;
        }

        static #hasProtocol(s) {
            return /^[a-zA-Z]+:\/\//i.test(s);
        }

        static #isUrl(s) {
            return /^((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)$/i.test(s);
        }

        static #parseQuery = (raw) => {
            const query = raw.trim();

            if (this.#isUrl(query)) {
                const url = this.#hasProtocol(query) ? query : `https://${query}`;
                return { query, url };
            }

            if (COMMANDS.has(query)) {
                const { command, key, url } = COMMANDS.get(query);
                return command ? Search.#parseQuery(command) : { key, query, url };
            }

            let splitBy = CONFIG.commandSearchDelimiter;
            const [searchKey, rawSearch] = query.split(new RegExp(`${splitBy}(.*)`));

            if (COMMANDS.has(searchKey)) {
                const { searchTemplate, url: base } = COMMANDS.get(searchKey);
                const search = rawSearch.trim();
                const url = Search.#formatSearchUrl(base, searchTemplate, search);
                return { key: searchKey, query, search, splitBy, url };
            }

            splitBy = CONFIG.commandPathDelimiter;
            const [pathKey, path] = query.split(new RegExp(`${splitBy}(.*)`));

            if (COMMANDS.has(pathKey)) {
                const { url: base } = COMMANDS.get(pathKey);
                const [baseUrl] = Search.#splitUrl(base);
                const url = `${baseUrl}/${path}`;
                return { key: pathKey, path, query, splitBy, url };
            }

            const [baseUrl, rest] = Search.#splitUrl(CONFIG.defaultSearchTemplate);
            const url = Search.#formatSearchUrl(baseUrl, rest, query);
            return { query, search: query, url };
        };

        static #splitUrl(url) {
            const parser = document.createElement('a');
            parser.href = url;
            const baseUrl = `${parser.protocol}//${parser.hostname}`;
            const rest = `${parser.pathname}${parser.search}`;
            return [baseUrl, rest];
        }

        #close() {
            this.#input.value = '';
            this.#input.blur();
            this.#dialog.close();
            this.#suggestions.innerHTML = '';
        }

        #execute(query) {
            const { url } = Search.#parseQuery(query);
            const target = CONFIG.openLinksInNewTab ? '_blank' : '_self';
            window.open(url, target, 'noopener noreferrer');
            this.#close();
        }

        #focusNextSuggestion(previous = false) {
            const active = this.shadowRoot.activeElement;
            let nextIndex;

            if (active.dataset.index) {
                const activeIndex = Number(active.dataset.index);
                nextIndex = previous ? activeIndex - 1 : activeIndex + 1;
            } else {
                nextIndex = previous ? this.#suggestions.childElementCount - 1 : 0;
            }

            const next = this.#suggestions.children[nextIndex];
            if (next) next.querySelector('.suggestion').focus();
            else this.#input.focus();
        }

        #onInput = async () => {
            const oq = Search.#parseQuery(this.#input.value);

            if (!oq.query) {
                this.#close();
                return;
            }

            let suggestions = COMMANDS.get(oq.query)?.suggestions ?? [];

            if (oq.search && suggestions.length < CONFIG.suggestionLimit) {
                const res = await Search.#fetchDuckDuckGoSuggestions(oq.search);
                const formatted = Search.#attachSearchPrefix(res, oq);
                suggestions = suggestions.concat(formatted);
            }

            const nq = Search.#parseQuery(this.#input.value);
            if (nq.query !== oq.query) return;
            this.#renderSuggestions(suggestions, oq.query);
        };

        #onKeydown = (e) => {
            if (!this.#dialog.open) {
                this.#dialog.show();
                this.#input.focus();

                requestAnimationFrame(() => {
                    // close the search dialog before the next repaint if a character is
                    // not produced (e.g. if you type shift, control, alt etc.)
                    if (!this.#input.value) this.#close();
                });

                return;
            }

            if (e.key === 'Escape') {
                this.#close();
                return;
            }

            const alt = e.altKey ? 'alt-' : '';
            const ctrl = e.ctrlKey ? 'ctrl-' : '';
            const meta = e.metaKey ? 'meta-' : '';
            const shift = e.shiftKey ? 'shift-' : '';
            const modifierPrefixedKey = `${alt}${ctrl}${meta}${shift}${e.key}`;

            if (/^(ArrowDown|Tab|ctrl-n)$/.test(modifierPrefixedKey)) {
                e.preventDefault();
                this.#focusNextSuggestion();
                return;
            }

            if (/^(ArrowUp|ctrl-p|shift-Tab)$/.test(modifierPrefixedKey)) {
                e.preventDefault();
                this.#focusNextSuggestion(true);
            }
        };

        #onSubmit = () => {
            this.#execute(this.#input.value);
        };

        #onSuggestionClick = (e) => {
            const ref = e.target.closest('.suggestion');
            if (!ref) return;
            this.#execute(ref.dataset.suggestion);
        };

        #renderSuggestions(suggestions, query) {
            this.#suggestions.innerHTML = '';
            const sliced = suggestions.slice(0, CONFIG.suggestionLimit);
            const template = document.getElementById('suggestion-template');

            for (const [index, suggestion] of sliced.entries()) {
                const clone = template.content.cloneNode(true);
                const ref = clone.querySelector('.suggestion');
                ref.dataset.index = index;
                ref.dataset.suggestion = suggestion;
                const escapedQuery = Search.#escapeRegexCharacters(query);
                const matched = suggestion.match(new RegExp(escapedQuery, 'i'));

                if (matched) {
                    const template = document.getElementById('match-template');
                    const clone = template.content.cloneNode(true);
                    const matchRef = clone.querySelector('.match');
                    const pre = suggestion.slice(0, matched.index);
                    const post = suggestion.slice(matched.index + matched[0].length);
                    matchRef.innerText = matched[0];
                    matchRef.insertAdjacentHTML('beforebegin', pre);
                    matchRef.insertAdjacentHTML('afterend', post);
                    ref.append(clone);
                } else {
                    ref.innerText = suggestion;
                }

                this.#suggestions.append(clone);
            }
        }
    }

    customElements.define('search-component', Search);
</script>

<style>
    html {
        background-color: var(--color-background);
        background-image: linear-gradient(135deg, #f8f5e6, #f2edd0);
        font-family: var(--font-family);
        font-size: var(--font-size);
        line-height: 1.4;
        height: 100%;
    }

    body {
        margin: 0;
        color: var(--color-text);
        height: 100%;
        visibility: visible; /* Changed from opacity to visibility */
    }

    /* Remove the opacity transition */
    body.loading {
        visibility: hidden; /* Hide during loading */
    }

    main {
        align-items: center;
        box-sizing: border-box;
        display: flex;
        justify-content: center;
        min-height: 100vh;
        overflow: hidden;
        padding: calc(var(--space) * 4) var(--space);
        position: relative;
        width: 100vw;
    }

    /* Hide the background element */
    bgelement {
        display: none;
    }

    /* Corner text styles */
    .corner-text {
        position: fixed;
        padding: 2rem;
        font-size: 0.68rem;
        line-height: 1.6;
        color: var(--color-text-subtle);
        opacity: 0.7;
        letter-spacing: 0.03em;
    }

    .top-left {
        top: 0;
        left: 0;
        text-align: left;
    }

    .top-right {
        top: 0;
        right: 0;
        text-align: right;
    }

    .bottom-left {
        bottom: 0;
        left: 0;
        text-align: left;
        max-width: 300px;
        font-style: italic;
    }

    .bottom-right {
        bottom: 0;
        right: 0;
        text-align: right;
    }

    .corner-text span {
        display: inline-block;
    }

    .corner-text .label {
        font-weight: var(--font-weight-bold);
        opacity: 0.8;
        margin-bottom: 0.3rem;
        text-transform: lowercase;
        letter-spacing: 0.05em;
    }
    
    #greeting, #quote, .bottom-right {
        opacity: 0.7;
    }
    
    #quote {
        font-size: 0.65rem;
        max-width: 250px;
        line-height: 1.7;
    }
    
    .bottom-right {
        font-size: 0.65rem;
        letter-spacing: 0.05em;
    }

    /* Settings dot styles */
    .settings-dot {
        position: fixed;
        bottom: 1rem;
        left: 50%;
        transform: translateX(-50%);
        width: 4px; /* Smaller visual dot */
        height: 4px; /* Smaller visual dot */
        background-color: var(--color-text-subtle);
        border-radius: 50%;
        opacity: 0.5;
        cursor: pointer;
        transition: all var(--transition-speed);
        z-index: 10;
        /* Make hit area much larger than visual dot */
        margin: 1.3rem;
        padding: 1px;
        box-sizing: content-box;
        /* Add subtle shadow to make it more visible */
        box-shadow: 0 0 2px rgba(0, 0, 0, 0.1);
        text-decoration: none;
        display: block;
    }

    .settings-dot:hover {
        opacity: 0.8;
        transform: translateX(-50%) scale(1.2);
        background-color: var(--color-accent);
        box-shadow: 0 0 4px rgba(0, 0, 0, 0.15);
    }
    
    /* Responsive styles for various screen sizes */
    @media (max-width: 768px) {
        main {
            padding: calc(var(--space) * 3) var(--space);
            align-items: flex-start;
            padding-top: 4rem;
        }
        
        .corner-text {
            padding: 1.5rem;
        }
    }
    
    @media (max-width: 480px) {
        main {
            padding: calc(var(--space) * 2) var(--space);
            align-items: flex-start;
            padding-top: 3.5rem;
        }
        
        .corner-text {
            padding: 1rem;
        }
        
        .settings-dot {
            bottom: 0.5rem;
        }
    }
</style>

<script>
    // Function to get time of day greeting
    function getGreeting() {
        const hour = new Date().getHours();
        if (hour < 12) return "good morning";
        if (hour < 18) return "good afternoon";
        return "good evening";
    }

    // Random quotes array
    const QUOTES = [
        "The only way to do great work is to love what you do.",
        "Your time is limited, don't waste it living someone else's life.",
        "Stay hungry, stay foolish.",
        "Innovation distinguishes between a leader and a follower.",
        "The greatest glory in living lies not in never falling, but in rising every time we fall.",
        "Education is the most powerful weapon which you can use to change the world.",
        "The only source of knowledge is experience.",
        "Imagination is more important than knowledge.",
        "Strive not to be a success, but rather to be of value.",
        "If you can't explain it simply, you don't understand it well enough."
    ];

    // Function to get random quote
    function getRandomQuote() {
        return QUOTES[Math.floor(Math.random() * QUOTES.length)];
    }

    // Function to load corner text from settings
    function loadCornerText() {
        try {
            const savedSettings = localStorage.getItem('homeSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                const cornerText = document.getElementById('corner-text');
                if (cornerText && settings.cornerText) {
                    cornerText.textContent = settings.cornerText;
                }
            }
        } catch (e) {
            console.error('Error loading corner text:', e);
        }
    }

    // Set corner text content when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('greeting').textContent = getGreeting();
        document.getElementById('quote').textContent = getRandomQuote();
        loadCornerText();
    });

    // Listen for theme changes to update corner text
    document.addEventListener('themeChanged', loadCornerText);

    // ===== GITHUB SYNC FUNCTIONALITY FOR MAIN PAGE =====

    // Escape HTML to prevent XSS
    function escapeHTML(str) {
        if (!str) return '';
        return str
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#039;');
    }

    // Load from gist on startup (simplified version for main page)
    async function loadFromGistOnStartup() {
        const githubToken = localStorage.getItem('githubToken');
        const gistId = localStorage.getItem('gistId');
        
        if (!githubToken || !gistId) return;

        try {
            const gistData = await getGistDataMain();
            if (!gistData) return;

            const localLastSync = parseInt(localStorage.getItem('lastSync') || '0');
            const gistLastSync = gistData.lastSync || 0;

            // Conflict resolution with 50ms buffer
            if (gistLastSync > localLastSync + 50) {
                console.log('Loading newer data from gist on startup');

                // Update settings
                if (gistData.settings) {
                    localStorage.setItem('homeSettings', JSON.stringify(gistData.settings));
                }

                // Update commands
                if (gistData.commands) {
                    localStorage.setItem('homeCommands', JSON.stringify(gistData.commands));
                    
                    // Update COMMANDS map
                    COMMANDS.clear();
                    for (const [key, value] of gistData.commands) {
                        COMMANDS.set(key, value);
                    }
                }

                localStorage.setItem('lastSync', gistLastSync.toString());

                // Reload the page to apply changes
                window.location.reload();
            }
        } catch (error) {
            console.error('Error loading from gist on startup:', error);
        }
    }

    // Get gist data (simplified version for main page)
    async function getGistDataMain() {
        const githubToken = localStorage.getItem('githubToken');
        const gistId = localStorage.getItem('gistId');
        
        if (!githubToken || !gistId) return null;

        try {
            const response = await fetch(`https://api.github.com/gists/${gistId}`, {
                headers: { 'Authorization': `token ${githubToken}` }
            });

            if (!response.ok) {
                if (response.status === 404) {
                    // Gist was deleted, clear the ID
                    localStorage.removeItem('gistId');
                    return null;
                }
                throw new Error(`GitHub API error: ${response.status} ${response.statusText}`);
            }

            const gist = await response.json();
            const fileContent = gist.files['home-sync-data.json']?.content;
            
            if (fileContent) {
                return JSON.parse(fileContent);
            }
        } catch (error) {
            console.error('Error getting gist data:', error);
            throw error;
        }

        return null;
    }

    // Call loadFromGistOnStartup when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        loadFromGistOnStartup();
    });
</script>

<style>
    /* New scroll section styles - not modifying any existing styles */
    html {
        scroll-behavior: smooth;
    }
    
    body {
        overflow: hidden; /* Prevent double scrollbars */
    }
    
    .app-container {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow-y: auto;
        overflow-x: hidden;
        scroll-snap-type: none; /* Remove snap scrolling */
        scroll-behavior: smooth;
        scroll-padding: 0;
    }
    
    main {
        height: 100vh;
        position: relative;
        min-height: 100vh;
        scroll-snap-align: none; /* Remove snap alignment */
        scroll-snap-stop: none; /* Remove snap stopping */
    }
    
    .scroll-section {
        min-height: auto; /* Allow natural height */
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        padding: 5rem 1rem 5rem;
        box-sizing: border-box;
        scroll-snap-align: none; /* Remove snap alignment */
        scroll-snap-stop: none; /* Remove snap stopping */
        background-color: var(--color-background);
        position: relative;
        height: auto;
        overflow-y: visible;
    }
    
    /* Create a pseudo-element to handle the background gradient */
    .scroll-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: -1;
        background-image: var(--background-gradient, linear-gradient(135deg, #f8f5e6, #f2edd0));
        opacity: 0.8;
    }
    
    .dark-mode .scroll-section::before {
        background-image: var(--background-gradient, linear-gradient(135deg, #222, #333));
    }
    
    .scroll-content {
        max-width: 90vw;
        width: 100%;
        border-radius: var(--border-radius);
        padding: 2rem;
        box-shadow: var(--box-shadow);
        margin-bottom: 2rem;
        backdrop-filter: blur(5px);
        background-color: rgba(255, 255, 255, 0.7);
        height: auto;
        min-height: 70vh;
    }
    
    .dark-mode .scroll-content {
        background-color: rgba(30, 30, 30, 0.7);
    }
    
    /* RSS Feed Layout Styles */
    .rss-container {
        width: 100%;
        display: grid;
        grid-template-columns: 1fr;
        gap: 2rem;
    }
    
    /* Feed section styling - matches the settings page */
    .feed-section {
        width: 100%;
        border-radius: var(--border-radius);
        overflow: hidden;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        margin-bottom: 2rem;
        max-width: 100%;
    }
    
    .dark-mode .feed-section {
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
    }
    
    /* Feed section header styling */
    .feed-section-header {
        display: flex;
        align-items: center;
        margin-bottom: 1.5rem;
    }
    
    .feed-section-title {
        font-size: 1.4rem;
        font-weight: 500;
        margin: 0;
        position: relative;
        padding-left: 1rem;
        color: var(--color-text);
    }
    
    .feed-section-title::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 4px;
        background-color: var(--color-accent);
        border-radius: 2px;
    }
    
    /* Grid for feed cards */
    .feed-cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
        gap: 2rem;
        width: 100%;
    }
    
    @media (max-width: 768px) {
        .feed-cards-grid {
            grid-template-columns: 1fr;
        }
    }
    
    /* Feed card styling - matches settings page cards */
    .feed-card {
        background: rgba(255, 255, 255, 0.5);
        border-radius: var(--border-radius);
        padding: 1.5rem;
        box-shadow: var(--box-shadow);
        border: 1px solid rgba(0, 0, 0, 0.05);
        display: flex;
        flex-direction: column;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .feed-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    
    .dark-mode .feed-card {
        background: rgba(40, 40, 40, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .dark-mode .feed-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
    
    /* Theme-specific feed card styling */
    [data-theme="minimal"] .feed-card {
        background: transparent;
        box-shadow: none;
        border: none;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        border-radius: 0;
    }
    
    [data-theme="minimal"].dark-mode .feed-card {
        background: transparent;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    [data-theme="minimal"] .feed-card:hover {
        transform: none;
        box-shadow: none;
    }
    
    [data-theme="glass"] .feed-card {
        backdrop-filter: blur(10px);
        background: rgba(255, 255, 255, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    [data-theme="glass"].dark-mode .feed-card {
        background: rgba(30, 41, 59, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    [data-theme="neon"] .feed-card {
        background: rgba(15, 15, 30, 0.7);
        border: 1px solid rgba(255, 0, 170, 0.3);
        box-shadow: 0 0 15px rgba(255, 0, 170, 0.1);
    }
    
    [data-theme="neon"].dark-mode .feed-card {
        background: rgba(10, 10, 20, 0.7);
        border: 1px solid rgba(0, 238, 255, 0.3);
        box-shadow: 0 0 15px rgba(0, 238, 255, 0.1);
    }
    
    [data-theme="neon"] .feed-card:hover {
        box-shadow: 0 0 20px rgba(255, 0, 170, 0.2);
    }
    
    [data-theme="neon"].dark-mode .feed-card:hover {
        box-shadow: 0 0 20px rgba(0, 238, 255, 0.2);
    }
    
    [data-theme="retro"] .feed-card {
        background: rgba(250, 244, 212, 0.9);
        border: 2px solid #562349;
        box-shadow: 4px 4px 0 rgba(86, 35, 73, 0.2);
        border-radius: 0;
    }
    
    [data-theme="retro"].dark-mode .feed-card {
        background: rgba(44, 19, 32, 0.9);
        border: 2px solid #f4b674;
        box-shadow: 4px 4px 0 rgba(244, 182, 116, 0.2);
    }
    
    [data-theme="retro"] .feed-card:hover {
        transform: translate(-2px, -2px);
        box-shadow: 6px 6px 0 rgba(86, 35, 73, 0.2);
    }
    
    [data-theme="retro"].dark-mode .feed-card:hover {
        box-shadow: 6px 6px 0 rgba(244, 182, 116, 0.2);
    }
    
    [data-theme="brutalist"] .feed-card {
        background: rgba(255, 255, 255, 0.8);
        border: 1px solid #000000;
        box-shadow: none;
        border-radius: 0;
    }
    
    [data-theme="brutalist"].dark-mode .feed-card {
        background: rgba(0, 0, 0, 0.8);
        border: 1px solid #ffffff;
    }
    
    [data-theme="brutalist"] .feed-card:hover {
        transform: none;
        box-shadow: none;
    }
    
    [data-theme="gaming"] .feed-card {
        background: rgba(26, 26, 26, 0.9);
        border: 1px solid rgba(0, 255, 102, 0.3);
        box-shadow: 0 0 15px rgba(0, 255, 102, 0.1);
    }
    
    [data-theme="gaming"].dark-mode .feed-card {
        background: rgba(15, 15, 15, 0.9);
    }
    
    [data-theme="gaming"] .feed-card:hover {
        box-shadow: 0 0 20px rgba(0, 255, 102, 0.3);
        border: 1px solid rgba(0, 255, 102, 0.5);
    }
    
    /* Cyberpunk theme feed card styling */
    [data-theme="cyberpunk"] .feed-card {
        background: rgba(12, 12, 20, 0.7);
        border: 1px solid rgba(255, 30, 86, 0.3);
        box-shadow: 0 0 30px rgba(255, 30, 86, 0.1);
        position: relative;
        overflow: hidden;
    }
    
    [data-theme="cyberpunk"].dark-mode .feed-card {
        background: rgba(8, 8, 16, 0.7);
        border: 1px solid rgba(0, 255, 230, 0.3);
        box-shadow: 0 0 30px rgba(0, 255, 230, 0.1);
    }
    
    [data-theme="cyberpunk"] .feed-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background: linear-gradient(to right, transparent, rgba(255, 30, 86, 0.7), transparent);
        z-index: 1;
    }
    
    [data-theme="cyberpunk"].dark-mode .feed-card::before {
        background: linear-gradient(to right, transparent, rgba(0, 255, 230, 0.7), transparent);
    }
    
    [data-theme="cyberpunk"] .feed-card:hover {
        box-shadow: 0 0 30px rgba(255, 30, 86, 0.3);
        border: 1px solid rgba(255, 30, 86, 0.5);
    }
    
    [data-theme="cyberpunk"].dark-mode .feed-card:hover {
        box-shadow: 0 0 30px rgba(0, 255, 230, 0.3);
        border: 1px solid rgba(0, 255, 230, 0.5);
    }
    
    [data-theme="cyberpunk"] .feed-card-header {
        border-bottom: 1px solid rgba(255, 30, 86, 0.3);
    }
    
    [data-theme="cyberpunk"].dark-mode .feed-card-header {
        border-bottom: 1px solid rgba(0, 255, 230, 0.3);
    }
    
    [data-theme="cyberpunk"] .feed-item {
        border-bottom: 1px solid rgba(255, 30, 86, 0.2);
    }
    
    [data-theme="cyberpunk"].dark-mode .feed-item {
        border-bottom: 1px solid rgba(0, 255, 230, 0.2);
    }
    
    /* Bauhaus theme feed card styling */
    [data-theme="bauhaus"] .feed-card {
        background: rgba(255, 255, 255, 0.9);
        border: 2px solid #000000;
        border-radius: 0;
        box-shadow: none;
        position: relative;
    }
    
    [data-theme="bauhaus"].dark-mode .feed-card {
        background: rgba(18, 18, 18, 0.9);
        border: 2px solid #ffffff;
    }
    
    [data-theme="bauhaus"] .feed-card::before {
        content: "";
        position: absolute;
        top: -10px;
        right: -10px;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background-color: #E40303;
        z-index: 1;
    }
    
    [data-theme="bauhaus"] .feed-card:nth-child(2n)::before {
        background-color: #0087CC;
    }
    
    [data-theme="bauhaus"] .feed-card:nth-child(3n)::before {
        background-color: #FFD700;
        border-radius: 0;
        width: 20px;
        height: 20px;
        transform: rotate(45deg);
    }
    
    [data-theme="bauhaus"] .feed-card:hover {
        transform: none;
        box-shadow: none;
    }
    
    [data-theme="bauhaus"] .feed-card-header {
        border-bottom: 2px solid #000000;
    }
    
    [data-theme="bauhaus"].dark-mode .feed-card-header {
        border-bottom: 2px solid #ffffff;
    }
    
    [data-theme="bauhaus"] .feed-item {
        border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    }
    
    [data-theme="bauhaus"].dark-mode .feed-item {
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    /* Vaporwave theme feed card styling */
    [data-theme="vaporwave"] .feed-card {
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 0;
        box-shadow: 0 8px 32px rgba(253, 122, 184, 0.2);
        transform-style: preserve-3d;
        position: relative;
    }
    
    [data-theme="vaporwave"].dark-mode .feed-card {
        background: rgba(45, 18, 89, 0.7);
        border: 1px solid rgba(117, 255, 225, 0.3);
        box-shadow: 0 8px 32px rgba(117, 255, 225, 0.2);
    }
    
    [data-theme="vaporwave"] .feed-card::before {
        content: "";
        position: absolute;
        top: 5px;
        left: 5px;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, rgba(117, 255, 225, 0.4), transparent);
        z-index: -1;
        transform: translateZ(-10px);
        pointer-events: none;
    }
    
    [data-theme="vaporwave"].dark-mode .feed-card::before {
        background: linear-gradient(135deg, rgba(253, 122, 184, 0.4), transparent);
    }
    
    [data-theme="vaporwave"] .feed-card:hover {
        transform: translateZ(10px);
        box-shadow: 0 12px 32px rgba(253, 122, 184, 0.3);
    }
    
    [data-theme="vaporwave"].dark-mode .feed-card:hover {
        box-shadow: 0 12px 32px rgba(117, 255, 225, 0.3);
    }
    
    [data-theme="vaporwave"] .feed-card-header {
        border-bottom: 1px solid rgba(198, 164, 242, 0.3);
    }
    
    [data-theme="vaporwave"].dark-mode .feed-card-header {
        border-bottom: 1px solid rgba(253, 122, 184, 0.3);
    }
    
    [data-theme="vaporwave"] .feed-title {
        font-family: "VT323", "Windows Command Prompt", monospace;
        font-size: 1.2em;
    }
    
    [data-theme="vaporwave"] .feed-card-title {
        font-family: "VT323", "Windows Command Prompt", monospace;
        font-size: 1.4em;
    }
    
    /* Nordic theme feed card styling */
    [data-theme="nordic"] .feed-card {
        background: rgba(248, 249, 250, 0.7);
        border: 1px solid rgba(222, 226, 230, 0.8);
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(222, 226, 230, 0.5);
    }
    
    [data-theme="nordic"].dark-mode .feed-card {
        background: rgba(33, 37, 41, 0.7);
        border: 1px solid rgba(52, 58, 64, 0.8);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    [data-theme="nordic"] .feed-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 24px rgba(94, 129, 172, 0.15);
    }
    
    [data-theme="nordic"].dark-mode .feed-card:hover {
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
    }
    
    [data-theme="nordic"] .feed-card-header {
        border-bottom: 1px solid rgba(222, 226, 230, 0.8);
    }
    
    [data-theme="nordic"].dark-mode .feed-card-header {
        border-bottom: 1px solid rgba(52, 58, 64, 0.8);
    }
    
    [data-theme="nordic"] .feed-card-title {
        color: #212529;
        font-weight: 500;
    }
    
    [data-theme="nordic"].dark-mode .feed-card-title {
        color: #e9ecef;
    }
    
    [data-theme="nordic"] .feed-card-source {
        background-color: rgba(94, 129, 172, 0.1);
        color: #5e81ac;
    }
    
    [data-theme="nordic"].dark-mode .feed-card-source {
        background-color: rgba(136, 192, 208, 0.1);
        color: #88c0d0;
    }
    
    /* Feed card header */
    .feed-card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }
    
    .dark-mode .feed-card-header {
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .feed-card-title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .feed-card-source {
        font-size: 0.8rem;
        opacity: 0.7;
        padding: 0.3rem 0.6rem;
        background-color: rgba(0, 0, 0, 0.05);
        border-radius: 20px;
    }
    
    .dark-mode .feed-card-source {
        background-color: rgba(255, 255, 255, 0.1);
    }
    
    /* Feed item styling */
    .feed-item {
        margin-bottom: 1rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }
    
    .dark-mode .feed-item {
        border-bottom: 1px solid rgba(255, 255, 255, 0.03);
    }
    
    .feed-item:last-child {
        margin-bottom: 0;
        padding-bottom: 0;
        border-bottom: none;
    }
    
    .feed-title {
        font-weight: 500;
        margin: 0 0 0.5rem 0;
        font-size: 1.1rem;
    }
    
    .feed-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.8rem;
        margin-bottom: 0.5rem;
        opacity: 0.7;
    }
    
    .feed-source {
        padding: 0.15rem 0.4rem;
        background-color: rgba(0, 0, 0, 0.05);
        border-radius: 4px;
        font-size: 0.75rem;
    }
    
    .dark-mode .feed-source {
        background-color: rgba(255, 255, 255, 0.1);
    }
    
    .feed-date {
        font-weight: 500;
        padding: 0.15rem 0.4rem;
        background-color: rgba(0, 0, 0, 0.05);
        border-radius: 4px;
        font-size: 0.75rem;
    }
    
    .dark-mode .feed-date {
        background-color: rgba(255, 255, 255, 0.1);
    }
    
    .feed-description {
        margin: 0.5rem 0;
        line-height: 1.5;
    }
    
    .feed-link {
        display: inline-block;
        margin-top: 0.5rem;
        color: var(--color-accent);
        text-decoration: none;
        font-size: 0.9rem;
        transition: all 0.2s ease;
        padding: 0.3rem 0.6rem;
        border-radius: 4px;
        background-color: rgba(0, 0, 0, 0.03);
    }
    
    .dark-mode .feed-link {
        background-color: rgba(255, 255, 255, 0.05);
    }
    
    .feed-link:hover {
        color: var(--color-hover);
        text-decoration: underline;
        background-color: rgba(0, 0, 0, 0.05);
    }
    
    .dark-mode .feed-link:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }
    
    /* Theme-specific feed link styling */
    [data-theme="neon"] .feed-link {
        background-color: rgba(255, 0, 170, 0.2);
        border: 1px solid rgba(255, 0, 170, 0.3);
        color: #fff;
        text-shadow: 0 0 5px rgba(255, 0, 170, 0.5);
    }
    
    [data-theme="neon"].dark-mode .feed-link {
        background-color: rgba(0, 238, 255, 0.2);
        border: 1px solid rgba(0, 238, 255, 0.3);
        text-shadow: 0 0 5px rgba(0, 238, 255, 0.5);
    }
    
    [data-theme="neon"] .feed-link:hover {
        background-color: rgba(255, 0, 170, 0.4);
        box-shadow: 0 0 10px rgba(255, 0, 170, 0.5);
        text-decoration: none;
    }
    
    [data-theme="neon"].dark-mode .feed-link:hover {
        background-color: rgba(0, 238, 255, 0.4);
        box-shadow: 0 0 10px rgba(0, 238, 255, 0.5);
    }
    
    [data-theme="retro"] .feed-link {
        background-color: #ca5fa6;
        color: #faf4d4;
        border: none;
        box-shadow: 2px 2px 0 rgba(86, 35, 73, 0.5);
        border-radius: 0;
    }
    
    [data-theme="retro"].dark-mode .feed-link {
        background-color: #f4b674;
        color: #2c1320;
        box-shadow: 2px 2px 0 rgba(244, 182, 116, 0.5);
    }
    
    [data-theme="retro"] .feed-link:hover {
        background-color: #562349;
        color: #f9c58d;
        transform: translate(-1px, -1px);
        box-shadow: 3px 3px 0 rgba(86, 35, 73, 0.5);
        text-decoration: none;
    }
    
    [data-theme="retro"].dark-mode .feed-link:hover {
        background-color: #f7d4a6;
        color: #42253b;
        box-shadow: 3px 3px 0 rgba(244, 182, 116, 0.5);
    }
    
    [data-theme="brutalist"] .feed-link {
        background-color: #000;
        color: #fff;
        border-radius: 0;
        padding: 0.4rem 1rem;
    }
    
    [data-theme="brutalist"].dark-mode .feed-link {
        background-color: #fff;
        color: #000;
    }
    
    [data-theme="brutalist"] .feed-link:hover {
        text-decoration: none;
        background-color: #333;
    }
    
    [data-theme="brutalist"].dark-mode .feed-link:hover {
        background-color: #ccc;
    }
    
    [data-theme="gaming"] .feed-link {
        background-color: rgba(0, 255, 102, 0.2);
        border: 1px solid rgba(0, 255, 102, 0.3);
        color: #00ff66;
    }
    
    [data-theme="gaming"] .feed-link:hover {
        background-color: rgba(0, 255, 102, 0.4);
        box-shadow: 0 0 10px rgba(0, 255, 102, 0.5);
        text-decoration: none;
    }
    
    /* Feed controls */
    .feed-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
    }
    
    .feed-title-section {
        display: flex;
        align-items: center;
    }
    
    .feed-title-section h2 {
        margin: 0;
        position: relative;
        padding-left: 1rem;
        color: var(--color-accent);
    }
    
    .feed-title-section h2::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 4px;
        background-color: var(--color-accent);
        border-radius: 2px;
    }
    
    .feed-title-section p {
        margin: 0 0 0 1rem;
        font-size: 0.9rem;
    }
    
    .feed-actions {
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .feed-sort-controls {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .feed-sort-label {
        font-size: 0.8rem;
        color: var(--color-text-subtle);
    }
    
    .feed-sort-select {
        padding: 0.5rem 1rem;
        border-radius: var(--border-radius);
        border: 1px solid rgba(0, 0, 0, 0.1);
        background-color: rgba(255, 255, 255, 0.7);
        font-size: 0.9rem;
        color: var(--color-text);
    }
    
    .dark-mode .feed-sort-select {
        background-color: rgba(0, 0, 0, 0.2);
        border-color: rgba(255, 255, 255, 0.1);
        color: var(--color-text);
    }
    
    .feed-sort-select:focus {
        outline: none;
        border-color: var(--color-accent);
    }
    
    .refresh-button {
        background-color: rgba(0, 0, 0, 0.05);
        border: none;
        border-radius: var(--border-radius);
        color: var(--color-text);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
        padding: 0.5rem 1rem;
        transition: all 0.2s ease;
    }
    
    .dark-mode .refresh-button {
        background-color: rgba(255, 255, 255, 0.1);
    }
    
    .refresh-button:hover {
        background-color: var(--color-accent);
        color: white;
    }
    
    /* Theme-specific refresh button styling */
    [data-theme="minimal"] .refresh-button {
        background-color: transparent;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 0;
    }
    
    [data-theme="minimal"].dark-mode .refresh-button {
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    [data-theme="minimal"] .refresh-button:hover {
        background-color: transparent;
        color: var(--color-accent);
        border-bottom-color: var(--color-accent);
    }
    
    [data-theme="glass"] .refresh-button {
        backdrop-filter: blur(5px);
        background-color: rgba(255, 255, 255, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    [data-theme="glass"].dark-mode .refresh-button {
        background-color: rgba(30, 41, 59, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    [data-theme="neon"] .refresh-button {
        background-color: rgba(255, 0, 170, 0.2);
        border: 1px solid rgba(255, 0, 170, 0.3);
        color: #fff;
        text-shadow: 0 0 5px rgba(255, 0, 170, 0.5);
    }
    
    [data-theme="neon"].dark-mode .refresh-button {
        background-color: rgba(0, 238, 255, 0.2);
        border: 1px solid rgba(0, 238, 255, 0.3);
        text-shadow: 0 0 5px rgba(0, 238, 255, 0.5);
    }
    
    [data-theme="neon"] .refresh-button:hover {
        background-color: rgba(255, 0, 170, 0.4);
        box-shadow: 0 0 10px rgba(255, 0, 170, 0.5);
    }
    
    [data-theme="neon"].dark-mode .refresh-button:hover {
        background-color: rgba(0, 238, 255, 0.4);
        box-shadow: 0 0 10px rgba(0, 238, 255, 0.5);
    }
    
    [data-theme="retro"] .refresh-button {
        background-color: #ca5fa6;
        color: #faf4d4;
        border: none;
        box-shadow: 2px 2px 0 rgba(86, 35, 73, 0.5);
        border-radius: 0;
    }
    
    [data-theme="retro"].dark-mode .refresh-button {
        background-color: #f4b674;
        color: #2c1320;
        box-shadow: 2px 2px 0 rgba(244, 182, 116, 0.5);
    }
    
    [data-theme="retro"] .refresh-button:hover {
        background-color: #562349;
        color: #f9c58d;
        transform: translate(-1px, -1px);
        box-shadow: 3px 3px 0 rgba(86, 35, 73, 0.5);
    }
    
    [data-theme="retro"].dark-mode .refresh-button:hover {
        background-color: #f7d4a6;
        color: #42253b;
        box-shadow: 3px 3px 0 rgba(244, 182, 116, 0.5);
    }
    
    [data-theme="brutalist"] .refresh-button {
        background-color: #000;
        color: #fff;
        border-radius: 0;
    }
    
    [data-theme="brutalist"].dark-mode .refresh-button {
        background-color: #fff;
        color: #000;
    }
    
    [data-theme="brutalist"] .refresh-button:hover {
        background-color: #333;
    }
    
    [data-theme="brutalist"].dark-mode .refresh-button:hover {
        background-color: #ccc;
    }
    
    [data-theme="gaming"] .refresh-button {
        background-color: rgba(0, 255, 102, 0.2);
        border: 1px solid rgba(0, 255, 102, 0.3);
        color: #00ff66;
    }
    
    [data-theme="gaming"] .refresh-button:hover {
        background-color: rgba(0, 255, 102, 0.4);
        box-shadow: 0 0 10px rgba(0, 255, 102, 0.5);
        color: #ffffff;
    }
    
    .refresh-icon {
        display: none;
        width: 14px;
        height: 14px;
        margin-right: 6px;
        position: relative;
        transition: transform 0.3s ease;
    }
    
    .refresh-icon::before {
        content: '';
        position: absolute;
        border: 2px solid currentColor;
        border-top-color: transparent;
        border-radius: 50%;
        width: 100%;
        height: 100%;
        box-sizing: border-box;
    }
    
    .refresh-icon::after {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        width: 0;
        height: 0;
        border-style: solid;
        border-width: 0 4px 4px 0;
        border-color: transparent currentColor transparent transparent;
        transform: rotate(-45deg);
    }
    
    .refresh-button.loading .refresh-icon {
        animation: spin 1s linear infinite;
    }
    
    /* Collapsible section styles */
    .feed-section.collapsible .feed-section-header {
        cursor: pointer;
        position: relative;
    }
    
    .feed-section.collapsible .feed-section-header::after {
        content: '';
        width: 0;
        height: 0;
        border-style: solid;
        border-width: 6px 6px 0 6px;
        border-color: var(--color-text-subtle) transparent transparent transparent;
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        transition: transform 0.2s ease;
    }
    
    .feed-section.collapsible .feed-cards-grid {
        overflow: hidden;
        max-height: 2000px;
        transition: max-height 0.5s ease;
    }
    
    .feed-section.collapsed .feed-cards-grid {
        max-height: 0;
    }
    
    .feed-section.collapsed .feed-section-header::after {
        transform: translateY(-50%) rotate(-90deg);
    }
    
    /* General styles */
    .feed-empty {
        padding: 2rem;
        text-align: center;
        color: var(--color-text-subtle);
        font-style: italic;
    }
    
    .feed-loading {
        text-align: center;
        padding: 2rem;
        color: var(--color-text-subtle);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
    }
    
    .feed-loading::after {
        content: "";
        width: 2rem;
        height: 2rem;
        border: 2px solid rgba(0, 0, 0, 0.1);
        border-top: 2px solid var(--color-accent);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    .dark-mode .feed-loading::after {
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-top: 2px solid var(--color-accent);
    }
</style>

<body>
<div class="app-container">
    <main>
        <commands-component></commands-component>
        <search-component></search-component>
    </main>

    <!-- New scrollable section -->
    <section class="scroll-section">
        <div class="scroll-content">
            <div id="rss-feed-container" class="rss-container">
                <div class="feed-loading">Loading feeds...</div>
            </div>
        </div>
    </section>

    <div class="corner-text top-left">
        <span class="label">home</span><br>
        <span class="label">links</span>
    </div>

    <div class="corner-text top-right">
        <span id="greeting">good day</span>
    </div>

    <div class="corner-text bottom-left">
        <span id="quote"></span>
    </div>

    <div class="corner-text bottom-right">
        <span id="corner-text">A. Magno</span>
    </div>
</div>
